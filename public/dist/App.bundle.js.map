{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/xtend/immutable.js","webpack:///./node_modules/@mapbox/mapbox-sdk/lib/constants.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/@mapbox/mapbox-sdk/lib/browser/browser-client.js","webpack:///./node_modules/@mapbox/mapbox-sdk/lib/classes/mapi-client.js","webpack:///./node_modules/@mapbox/parse-mapbox-token/index.js","webpack:///(webpack)/buildin/amd-options.js","webpack:///./public/javascripts/delicious-app.js","webpack:///./public/javascripts/modules/bling.js","webpack:///./public/javascripts/modules/autocomplete.js","webpack:///./node_modules/@mapbox/mapbox-gl-geocoder/lib/index.js","webpack:///./node_modules/suggestions/index.js","webpack:///./node_modules/suggestions/src/suggestions.js","webpack:///./node_modules/fuzzy/lib/fuzzy.js","webpack:///./node_modules/suggestions/src/list.js","webpack:///./node_modules/lodash.debounce/index.js","webpack:///./node_modules/events/events.js","webpack:///./node_modules/@mapbox/mapbox-gl-geocoder/lib/exceptions.js","webpack:///./node_modules/@mapbox/mapbox-sdk/index.js","webpack:///./node_modules/@mapbox/mapbox-sdk/lib/browser/browser-layer.js","webpack:///./node_modules/@mapbox/mapbox-sdk/lib/classes/mapi-response.js","webpack:///./node_modules/@mapbox/mapbox-sdk/lib/helpers/parse-link-header.js","webpack:///./node_modules/@mapbox/mapbox-sdk/lib/classes/mapi-error.js","webpack:///./node_modules/@mapbox/mapbox-sdk/lib/helpers/parse-headers.js","webpack:///./node_modules/base-64/base64.js","webpack:///(webpack)/buildin/module.js","webpack:///./node_modules/@mapbox/mapbox-sdk/lib/classes/mapi-request.js","webpack:///./node_modules/eventemitter3/index.js","webpack:///./node_modules/@mapbox/mapbox-sdk/lib/helpers/url-utils.js","webpack:///./node_modules/@mapbox/mapbox-sdk/services/geocoding.js","webpack:///./node_modules/@mapbox/mapbox-sdk/services/service-helpers/validator.js","webpack:///./node_modules/@mapbox/fusspot/lib/index.js","webpack:///./node_modules/is-plain-obj/index.js","webpack:///./node_modules/@mapbox/mapbox-sdk/services/service-helpers/pick.js","webpack:///./node_modules/@mapbox/mapbox-sdk/services/service-helpers/stringify-booleans.js","webpack:///./node_modules/@mapbox/mapbox-sdk/services/service-helpers/object-map.js","webpack:///./node_modules/@mapbox/mapbox-sdk/services/service-helpers/create-service-factory.js","webpack:///./node_modules/@mapbox/mapbox-gl-geocoder/lib/events.js","webpack:///./node_modules/nanoid/index.browser.js","webpack:///./node_modules/@mapbox/mapbox-gl-geocoder/lib/localization.js","webpack:///./node_modules/subtag/subtag.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","target","arguments","length","source","API_ORIGIN","EVENT_PROGRESS_DOWNLOAD","EVENT_PROGRESS_UPLOAD","EVENT_ERROR","EVENT_RESPONSE","ERROR_HTTP","ERROR_REQUEST_ABORTED","g","this","Function","e","window","browser","require","MapiClient","BrowserClient","options","constructor","sendRequest","browserSend","abortRequest","browserAbort","parseToken","MapiRequest","constants","accessToken","Error","origin","createRequest","requestOptions","base64","tokenCache","has","obj","token","parts","split","usage","rawPayload","parsedPayload","JSON","parse","decode","parseError","parsePaylod","result","user","u","authorization","a","expires","exp","created","iat","scopes","client","lastLogin","ll","impersonator","iu","__webpack_amd_options__","$","document","querySelector","$$","querySelectorAll","Node","on","fn","addEventListener","NodeList","__proto__","Array","forEach","elem","MapboxGeocoder","input","latInput","lngInput","mapboxgl","geocoder","addTo","place_name","geometry","coordinates","style","Typeahead","debounce","extend","EventEmitter","exceptions","MapboxClient","mbxGeocoder","MapboxEventManager","localization","subtag","_eventEmitter","inputString","fresh","lastSelected","zoom","flyTo","trackProximity","minLength","reverseGeocode","limit","enableEventLogging","marker","collapsed","clearAndBlurOnEsc","clearOnBlur","getItemValue","item","render","placeName","splice","join","container","_controlContainer","addControl","startsWith","parent","parentEl","el","onAdd","appendChild","map","_map","setLanguage","localGeocoderOnly","geocoderService","localGeocoder","eventManager","_onChange","_onKeyDown","_onPaste","_onBlur","_showButton","_hideButton","_onQueryResult","clear","_updateProximity","_collapse","_unCollapse","_clear","_clearOnBlur","createElement","className","searchIcon","createIcon","_inputEl","type","setPlaceholder","keyevent","actions","classList","add","_clearEl","setAttribute","buttonIcon","_loadingEl","_typeahead","filter","setRenderFunction","mapMarker","_handleMarker","_mapboxgl","console","error","path","icon","createElementNS","innerHTML","onRemove","parentNode","removeChild","off","_removeMarker","clipboardData","getData","_geocode","ESC_KEY_CODE","TAB_KEY_CODE","keyCode","blur","shadowRoot","activeElement","display","metaKey","indexOf","selected","stringify","flyOptions","properties","short_code","bbox","fitBounds","defaultFlyOptions","center","focus","scrollLeft","setSelectionRange","emit","select","searchInput","query","request","self","config","reduce","longitude","latitude","Promise","resolve","test","coords","parseFloat","reverse","types","send","forwardGeocode","localGeocoderRes","then","response","res","statusCode","body","headers","features","start","concat","update","_renderNoResults","catch","err","_renderError","ev","preventDefault","relatedTarget","results","getZoom","getCenter","wrap","setProximity","lng","lat","remove","_renderMessage","msg","renderError","_getPlaceholderText","placeholder","language","firstLanguage","localizedValue","setInput","proximity","getProximity","getRenderFunction","browserLocale","navigator","userLanguage","browserLanguage","getLanguage","setZoom","getFlyTo","setFlyTo","getPlaceholder","getBbox","setBbox","getCountries","countries","setCountries","getTypes","setTypes","getMinLength","setMinLength","getLimit","setLimit","getFilter","setFilter","setOrigin","getOrigin","markerOptions","color","Marker","setLngLat","removeListener","Suggestions","fuzzy","List","data","hideOnBlur","list","draw","handleKeyUp","handleKeyDown","handleFocus","handleBlur","handlePaste","handleInputChange","isEmpty","isVisible","items","active","original","hide","previous","next","selectingListItem","setTimeout","normalize","getCandidates","show","revisedData","toLowerCase","match","candidate","createEvent","initEvent","dispatchEvent","fireEvent","callback","pre","post","extract","string","sourceFormatting","boldString","indexString","indexOfQuery","lastIndexOf","endIndexOfQuery","slice","drawError","simpleFilter","pattern","array","str","opts","ch","patternIdx","len","totalScore","currScore","compareString","caseSensitive","idx","Infinity","rendered","score","arr","prev","element","index","sort","b","compare","component","wrapper","insertBefore","nextSibling","push","drawItem","li","handleMouseUp","move","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","parseInt","freeGlobal","global","freeSelf","root","objectToString","toString","nativeMax","Math","max","nativeMin","min","now","Date","isObject","isSymbol","isObjectLike","toNumber","other","valueOf","replace","isBinary","func","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","TypeError","invokeFunc","time","args","thisArg","undefined","apply","leadingEdge","timerExpired","shouldInvoke","timeSinceLastCall","trailingEdge","remainingWait","debounced","isInvoking","cancel","clearTimeout","flush","ReflectOwnKeys","R","Reflect","ReflectApply","receiver","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","NumberIsNaN","Number","isNaN","init","_events","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","_getMaxListeners","that","_addListener","prepend","events","existing","warning","newListener","unshift","warned","w","String","emitter","count","warn","onceWrapper","fired","wrapFn","_onceWrap","state","wrapped","_listeners","unwrap","evlistener","ret","unwrapListeners","arrayClone","listenerCount","copy","set","arg","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","er","message","context","handler","listeners","addListener","prependListener","once","prependOnceListener","position","originalListener","shift","pop","spliceOne","removeAllListeners","keys","rawListeners","eventNames","MapiResponse","MapiError","parseHeaders","requestsUnderway","normalizeBrowserProgressEvent","event","total","transferred","loaded","percent","sendRequestXhr","xhr","reject","onprogress","file","upload","onerror","onabort","mapiError","onload","id","status","getAllResponseHeaders","createResponse","createRequestXhr","url","XMLHttpRequest","open","method","setRequestHeader","abort","parseLinkHeader","responseData","rawBody","links","link","hasNextPage","nextPage","_extend","linkHeader","parsed","linkUrl","linkParams","rel","parsedLinkParams","param","parseParam","params","parseLink","errorType","raw","trim","rawHeader","boundary","substring","parseSingleHeader","freeExports","freeModule","InvalidCharacterError","TABLE","REGEX_SPACE_CHARACTERS","buffer","padding","output","charCodeAt","charAt","bitStorage","bitCounter","fromCharCode","define","nodeType","webpackPolyfill","deprecate","paths","children","xtend","urlUtils","requestId","defaultHeaders","headersWithDefaults","memo","_options","sent","aborted","prependOrigin","appendQueryObject","routeParams","appendQueryParam","accessTokenOwnerId","ownerId","interpolateRouteParams","_nextPageRequest","eachPage","handleResponse","nextPageRequest","getPage","handleError","clone","extendedOptions","prefix","Events","EE","evt","clearEvent","names","handlers","ee","a1","a2","a3","a4","a5","j","prefixed","encodeValue","isArray","encodeURIComponent","punctuation","queryObject","v","delimiter","route","_","paramId","pick","stringifyBooleans","createServiceFactory","Geocoding","featureTypes","assertShape","required","oneOf","arrayOf","autocomplete","boolean","number","country","reverseMode","Blob","ArrayBuffer","pipe","date","getTime","tuple","validatorObj","apiName","assert","strictShape","isPlainObject","createArrayValidator","validators","validatingTuple","validationResult","validate","plainArray","validator","processMessage","formatErrorMessage","nounPhrase","addArticle","prettifyResult","orList","prettyResult","isArrayCulprit","rootValidator","errorMessage","shape","plainObject","errorMessages","objectId","shapeValidator","shapeResult","invalidKeys","valueKey","requiredValidator","__required","oneOfType","messages","Boolean","every","equal","compareWith","range","any","x","val","objectMap","cb","createClient","ServicePrototype","clientOrConfig","isPrototypeOf","service","nanoid","endpoint","access_token","version","sessionID","generateSessionID","userAgent","getUserAgent","locale","shouldEnableLogging","eventQueue","flushInterval","maxQueueSize","timer","lastSentInput","lastSentIndex","resultIndex","getSelectedIndex","payload","getEventPayload","resultPlaceName","resultId","queryString","keyEvent","lastAction","getRequestOptions","host","sessionIdentifier","mapZoom","keyboardLocale","xhttp","header","onreadystatechange","readyState","statusText","headerValue","selectedID","feature","forceFlush","crypto","msCrypto","size","bytes","getRandomValues","Uint8Array","make","tag","api","extlang","script","region","expose","part"],"mappings":"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","file":"App.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n","module.exports = extend\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction extend() {\n    var target = {}\n\n    for (var i = 0; i < arguments.length; i++) {\n        var source = arguments[i]\n\n        for (var key in source) {\n            if (hasOwnProperty.call(source, key)) {\n                target[key] = source[key]\n            }\n        }\n    }\n\n    return target\n}\n","'use strict';\n\nmodule.exports = {\n  API_ORIGIN: 'https://api.mapbox.com',\n  EVENT_PROGRESS_DOWNLOAD: 'downloadProgress',\n  EVENT_PROGRESS_UPLOAD: 'uploadProgress',\n  EVENT_ERROR: 'error',\n  EVENT_RESPONSE: 'response',\n  ERROR_HTTP: 'HttpError',\n  ERROR_REQUEST_ABORTED: 'RequestAbortedError'\n};\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict';\n\nvar browser = require('./browser-layer');\nvar MapiClient = require('../classes/mapi-client');\n\nfunction BrowserClient(options) {\n  MapiClient.call(this, options);\n}\nBrowserClient.prototype = Object.create(MapiClient.prototype);\nBrowserClient.prototype.constructor = BrowserClient;\n\nBrowserClient.prototype.sendRequest = browser.browserSend;\nBrowserClient.prototype.abortRequest = browser.browserAbort;\n\n/**\n * Create a client for the browser.\n *\n * @param {Object} options\n * @param {string} options.accessToken\n * @param {string} [options.origin]\n * @returns {MapiClient}\n */\nfunction createBrowserClient(options) {\n  return new BrowserClient(options);\n}\n\nmodule.exports = createBrowserClient;\n","'use strict';\n\nvar parseToken = require('@mapbox/parse-mapbox-token');\nvar MapiRequest = require('./mapi-request');\nvar constants = require('../constants');\n\n/**\n * A low-level Mapbox API client. Use it to create service clients\n * that share the same configuration.\n *\n * Services and `MapiRequest`s use the underlying `MapiClient` to\n * determine how to create, send, and abort requests in a way\n * that is appropriate to the configuration and environment\n * (Node or the browser).\n *\n * @class MapiClient\n * @property {string} accessToken - The Mapbox access token assigned\n *   to this client.\n * @property {string} [origin] - The origin\n *   to use for API requests. Defaults to https://api.mapbox.com.\n */\n\nfunction MapiClient(options) {\n  if (!options || !options.accessToken) {\n    throw new Error('Cannot create a client without an access token');\n  }\n  // Try parsing the access token to determine right away if it's valid.\n  parseToken(options.accessToken);\n\n  this.accessToken = options.accessToken;\n  this.origin = options.origin || constants.API_ORIGIN;\n}\n\nMapiClient.prototype.createRequest = function createRequest(requestOptions) {\n  return new MapiRequest(this, requestOptions);\n};\n\nmodule.exports = MapiClient;\n","'use strict';\n\nvar base64 = require('base-64');\n\nvar tokenCache = {};\n\nfunction parseToken(token) {\n  if (tokenCache[token]) {\n    return tokenCache[token];\n  }\n\n  var parts = token.split('.');\n  var usage = parts[0];\n  var rawPayload = parts[1];\n  if (!rawPayload) {\n    throw new Error('Invalid token');\n  }\n\n  var parsedPayload = parsePaylod(rawPayload);\n\n  var result = {\n    usage: usage,\n    user: parsedPayload.u\n  };\n  if (has(parsedPayload, 'a')) result.authorization = parsedPayload.a;\n  if (has(parsedPayload, 'exp')) result.expires = parsedPayload.exp * 1000;\n  if (has(parsedPayload, 'iat')) result.created = parsedPayload.iat * 1000;\n  if (has(parsedPayload, 'scopes')) result.scopes = parsedPayload.scopes;\n  if (has(parsedPayload, 'client')) result.client = parsedPayload.client;\n  if (has(parsedPayload, 'll')) result.lastLogin = parsedPayload.ll;\n  if (has(parsedPayload, 'iu')) result.impersonator = parsedPayload.iu;\n\n  tokenCache[token] = result;\n  return result;\n}\n\nfunction parsePaylod(rawPayload) {\n  try {\n    return JSON.parse(base64.decode(rawPayload));\n  } catch (parseError) {\n    throw new Error('Invalid token');\n  }\n}\n\nfunction has(obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n}\n\nmodule.exports = parseToken;\n","/* globals __webpack_amd_options__ */\nmodule.exports = __webpack_amd_options__;\n","import '../sass/style.scss'\n\nimport { $, $$ } from './modules/bling'\nimport autocomplete from './modules/autocomplete'\n\nautocomplete($('#address'), $('#lat'), $('#lng'))","// based on https://gist.github.com/paulirish/12fb951a8b893a454b32\n\nconst $ = document.querySelector.bind(document);\nconst $$ = document.querySelectorAll.bind(document);\n\nNode.prototype.on = window.on = function (name, fn) {\n  this.addEventListener(name, fn);\n};\n\nNodeList.prototype.__proto__ = Array.prototype; // eslint-disable-line\n\nNodeList.prototype.on = NodeList.prototype.addEventListener = function (name, fn) {\n  this.forEach((elem) => {\n    elem.on(name, fn);\n  });\n};\n\nexport { $, $$ };\n","const MapboxGeocoder = require('@mapbox/mapbox-gl-geocoder')\n\nfunction autocomplete(input, latInput, lngInput) {\n  if (!input) return\n\n  const MAPBOX_KEY =\n    'pk.eyJ1IjoiamVuYXJvOTQiLCJhIjoiY2pzbnBpajh3MGV5MTQ0cnJ3dmJlczFqbiJ9.Aktxa1EqTzpy7yEaBDM1xQ'\n  mapboxgl.accessToken = MAPBOX_KEY\n\n  let geocoder = new MapboxGeocoder({\n    accessToken: mapboxgl.accessToken,\n    mapboxgl: mapboxgl,\n  })\n\n  geocoder.addTo('#search-address')\n  geocoder.on('result', e => {\n    input.value = e.result.place_name\n    latInput.value = e.result.geometry.coordinates[0]\n    lngInput.value = e.result.geometry.coordinates[1]\n  })\n\n  document.querySelector('#search-address>div').style =\n    'width: 100%; max-width: unset; border: 1px solid #e6e6e6; box-shadow: unset; border-radius: 0; z-index: 1000; font-family: sans-serif; font-size: 100%; line-height: 1.15; margin: 0 0 10px 0;'\n}\n\nexport default autocomplete\n","'use strict';\n\nvar Typeahead = require('suggestions');\nvar debounce = require('lodash.debounce');\nvar extend = require('xtend');\nvar EventEmitter = require('events').EventEmitter;\nvar exceptions = require('./exceptions');\nvar MapboxClient = require('@mapbox/mapbox-sdk');\nvar mbxGeocoder = require('@mapbox/mapbox-sdk/services/geocoding');\nvar MapboxEventManager = require('./events');\nvar localization = require('./localization');\nvar subtag = require('subtag');\n\n/**\n * A geocoder component using the [Mapbox Geocoding API](https://docs.mapbox.com/api/search/#geocoding)\n * @class MapboxGeocoder\n * @param {Object} options\n * @param {String} options.accessToken Required.\n * @param {String} [options.origin=https://api.mapbox.com] Use to set a custom API origin.\n * @param {Object} [options.mapboxgl] A [mapbox-gl](https://github.com/mapbox/mapbox-gl-js) instance to use when creating [Markers](https://docs.mapbox.com/mapbox-gl-js/api/#marker). Required if `options.marker` is `true`.\n * @param {Number} [options.zoom=16] On geocoded result what zoom level should the map animate to when a `bbox` isn't found in the response. If a `bbox` is found the map will fit to the `bbox`.\n * @param {Boolean|Object} [options.flyTo=true] If `false`, animating the map to a selected result is disabled. If `true`, animating the map will use the default animation parameters. If an object, it will be passed as `options` to the map [`flyTo`](https://docs.mapbox.com/mapbox-gl-js/api/#map#flyto) or [`fitBounds`](https://docs.mapbox.com/mapbox-gl-js/api/#map#fitbounds) method providing control over the animation of the transition.\n * @param {String} [options.placeholder=Search] Override the default placeholder attribute value.\n * @param {Object} [options.proximity] a proximity argument: this is\n * a geographical point given as an object with `latitude` and `longitude`\n * properties. Search results closer to this point will be given\n * higher priority.\n * @param {Boolean} [options.trackProximity=true] If `true`, the geocoder proximity will automatically update based on the map view.\n * @param {Boolean} [options.collapsed=false] If `true`, the geocoder control will collapse until hovered or in focus.\n * @param {Boolean} [options.clearAndBlurOnEsc=false] If `true`, the geocoder control will clear it's contents and blur when user presses the escape key.\n * @param {Boolean} [options.clearOnBlur=false] If `true`, the geocoder control will clear its value when the input blurs.\n * @param {Array} [options.bbox] a bounding box argument: this is\n * a bounding box given as an array in the format `[minX, minY, maxX, maxY]`.\n * Search results will be limited to the bounding box.\n * @param {string} [options.countries] a comma separated list of country codes to\n * limit results to specified country or countries.\n * @param {string} [options.types] a comma seperated list of types that filter\n * results to match those specified. See https://docs.mapbox.com/api/search/#data-types\n * for available types.\n * If reverseGeocode is enabled, you should specify one type. If you configure more than one type, the first type will be used.\n * @param {Number} [options.minLength=2] Minimum number of characters to enter before results are shown.\n * @param {Number} [options.limit=5] Maximum number of results to show.\n * @param {string} [options.language] Specify the language to use for response text and query result weighting. Options are IETF language tags comprised of a mandatory ISO 639-1 language code and optionally one or more IETF subtags for country or script. More than one value can also be specified, separated by commas. Defaults to the browser's language settings.\n * @param {Function} [options.filter] A function which accepts a Feature in the [Carmen GeoJSON](https://github.com/mapbox/carmen/blob/master/carmen-geojson.md) format to filter out results from the Geocoding API response before they are included in the suggestions list. Return `true` to keep the item, `false` otherwise.\n * @param {Function} [options.localGeocoder] A function accepting the query string which performs local geocoding to supplement results from the Mapbox Geocoding API. Expected to return an Array of GeoJSON Features in the [Carmen GeoJSON](https://github.com/mapbox/carmen/blob/master/carmen-geojson.md) format.\n * @param {distance|score} [options.reverseMode=distance] - Set the factors that are used to sort nearby results.\n * @param {boolean} [options.reverseGeocode=false] If `true`, enable reverse geocoding mode. In reverse geocoding, search input is expected to be coordinates in the form `lat, lon`, with suggestions being the reverse geocodes.\n * @param {Boolean} [options.enableEventLogging=true] Allow Mapbox to collect anonymous usage statistics from the plugin.\n * @param {Boolean|Object} [options.marker=true]  If `true`, a [Marker](https://docs.mapbox.com/mapbox-gl-js/api/#marker) will be added to the map at the location of the user-selected result using a default set of Marker options.  If the value is an object, the marker will be constructed using these options. If `false`, no marker will be added to the map. Requires that `options.mapboxgl` also be set.\n * @param {Function} [options.render] A function that specifies how the results should be rendered in the dropdown menu. This function should accepts a single [Carmen GeoJSON](https://github.com/mapbox/carmen/blob/master/carmen-geojson.md) object as input and return a string. Any HTML in the returned string will be rendered.\n * @param {Function} [options.getItemValue] A function that specifies how the selected result should be rendered in the search bar. This function should accept a single [Carmen GeoJSON](https://github.com/mapbox/carmen/blob/master/carmen-geojson.md) object as input and return a string. HTML tags in the output string will not be rendered. Defaults to `(item) => item.place_name`.\n * @param {String} [options.mode=mapbox.places] A string specifying the geocoding [endpoint](https://docs.mapbox.com/api/search/#endpoints) to query. Options are `mapbox.places` and `mapbox.places-permanent`. The `mapbox.places-permanent` mode requires an enterprise license for permanent geocodes.\n * @param {Boolean} [options.localGeocoderOnly=false] If `true`, indicates that the `localGeocoder` results should be the only ones returned to the user. If `false`, indicates that the `localGeocoder` results should be combined with those from the Mapbox API with the `localGeocoder` results ranked higher.\n * @example\n * var geocoder = new MapboxGeocoder({ accessToken: mapboxgl.accessToken });\n * map.addControl(geocoder);\n * @return {MapboxGeocoder} `this`\n *\n */\n\nfunction MapboxGeocoder(options) {\n  this._eventEmitter = new EventEmitter();\n  this.options = extend({}, this.options, options);\n  this.inputString = '';\n  this.fresh = true;\n  this.lastSelected = null;\n}\n\nMapboxGeocoder.prototype = {\n  options: {\n    zoom: 16,\n    flyTo: true,\n    trackProximity: true,\n    minLength: 2,\n    reverseGeocode: false,\n    limit: 5,\n    origin: 'https://api.mapbox.com',\n    enableEventLogging: true,\n    marker: true,\n    mapboxgl: null,\n    collapsed: false,\n    clearAndBlurOnEsc: false,\n    clearOnBlur: false,\n    getItemValue: function(item) {\n      return item.place_name\n    },\n    render: function(item) {\n      var placeName = item.place_name.split(',');\n      return '<div class=\"mapboxgl-ctrl-geocoder--suggestion\"><div class=\"mapboxgl-ctrl-geocoder--suggestion-title\">' + placeName[0]+ '</div><div class=\"mapboxgl-ctrl-geocoder--suggestion-address\">' + placeName.splice(1, placeName.length).join(',') + '</div></div>';\n    }\n  },\n\n  /**\n   * Add the geocoder to a container. The container can be either a `mapboxgl.Map` or a reference to an HTML `class` or `id`.\n   *\n   * If the container is a `mapboxgl.Map`, this function will behave identically to `Map.addControl(geocoder)`.\n   * If the container is an HTML `id` or `class`, the geocoder will be appended to that element.\n   *\n   * This function will throw an error if the container is not either a map or a `class`/`id` reference.\n   * It will also throw an error if the referenced HTML element cannot be found in the `document.body`.\n   *\n   * For example, if the HTML body contains the element `<div id='geocoder-container'></div>`, the following script will append the geocoder to `#geocoder-container`:\n   *\n   * ```javascript\n   * var geocoder = new MapboxGeocoder({ accessToken: mapboxgl.accessToken });\n   * geocoder.addTo('#geocoder-container');\n   * ```\n   * @param {String|mapboxgl.Map} container A reference to the container to which to add the geocoder\n   */\n  addTo: function(container){\n    // if the container is a map, add the control like normal\n    if (container._controlContainer){\n      //  it's a mapbox-gl map, add like normal\n      container.addControl(this)\n    }\n    // if the container is not a map, but an html element, then add the control to that element\n    else if (typeof container == 'string' && (container.startsWith('#') || container.startsWith('.'))){\n      const parent = document.querySelectorAll(container);\n      if (parent.length == 0){\n        throw new Error(\"Element \", container, \"not found.\")\n      }\n\n      if (parent.length > 1){\n        throw new Error(\"Geocoder can only be added to a single html element\")\n      }\n\n      parent.forEach(function(parentEl){\n        const el = this.onAdd(); //returns the input elements, which are then added to the requested html container\n        parentEl.appendChild(el);\n      }.bind(this))\n\n    }else{\n      throw new Error(\"Error: addTo Container must be a mapbox-gl-js map or a html element reference\")\n    }\n  },\n\n  onAdd: function(map) {\n    if (map && typeof map != 'string'){\n      this._map = map;\n    }\n\n    this.setLanguage();\n\n    if (!this.options.localGeocoderOnly){\n      this.geocoderService = mbxGeocoder(\n        MapboxClient({\n          accessToken: this.options.accessToken,\n          origin: this.options.origin\n        })\n      );\n    }\n\n    if (this.options.localGeocoderOnly && !this.options.localGeocoder){\n      throw new Error(\"A localGeocoder function must be specified to use localGeocoderOnly mode\")\n    }\n\n    this.eventManager = new MapboxEventManager(this.options);\n\n    this._onChange = this._onChange.bind(this);\n    this._onKeyDown = this._onKeyDown.bind(this);\n    this._onPaste = this._onPaste.bind(this);\n    this._onBlur = this._onBlur.bind(this);\n    this._showButton = this._showButton.bind(this);\n    this._hideButton = this._hideButton.bind(this);\n    this._onQueryResult = this._onQueryResult.bind(this);\n    this.clear = this.clear.bind(this);\n    this._updateProximity = this._updateProximity.bind(this);\n    this._collapse = this._collapse.bind(this);\n    this._unCollapse = this._unCollapse.bind(this);\n    this._clear = this._clear.bind(this);\n    this._clearOnBlur = this._clearOnBlur.bind(this);\n\n    var el = (this.container = document.createElement('div'));\n    el.className = 'mapboxgl-ctrl-geocoder mapboxgl-ctrl';\n\n    var searchIcon = this.createIcon('search', '<path d=\"M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z\"/>')\n\n    this._inputEl = document.createElement('input');\n    this._inputEl.type = 'text';\n    this._inputEl.className = 'mapboxgl-ctrl-geocoder--input';\n\n    this.setPlaceholder();\n\n    if (this.options.collapsed) {\n      this._collapse();\n      this.container.addEventListener('mouseenter', this._unCollapse);\n      this.container.addEventListener('mouseleave', this._collapse);\n      this._inputEl.addEventListener('focus', this._unCollapse);\n    }\n\n    if (this.options.collapsed || this.options.clearOnBlur) {\n      this._inputEl.addEventListener('blur', this._onBlur);\n    }\n\n    this._inputEl.addEventListener('keydown', debounce(this._onKeyDown, 200));\n    this._inputEl.addEventListener('paste', this._onPaste);\n    this._inputEl.addEventListener('change', this._onChange);\n    this.container.addEventListener('mouseenter', this._showButton);\n    this.container.addEventListener('mouseleave', this._hideButton);\n    this._inputEl.addEventListener('keyup', function(e){\n      this.eventManager.keyevent(e, this);\n    }.bind(this));\n\n    var actions = document.createElement('div');\n    actions.classList.add('mapboxgl-ctrl-geocoder--pin-right');\n\n    this._clearEl = document.createElement('button');\n    this._clearEl.setAttribute('aria-label', 'Clear');\n    this._clearEl.addEventListener('click', this.clear);\n    this._clearEl.className = 'mapboxgl-ctrl-geocoder--button';\n\n    var buttonIcon = this.createIcon('close', '<path d=\"M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z\"/>')\n    this._clearEl.appendChild(buttonIcon);\n\n    this._loadingEl = this.createIcon('loading', '<path fill=\"#333\" d=\"M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z\"/><path opacity=\".1\" d=\"M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z\"/>');\n\n    actions.appendChild(this._clearEl);\n    actions.appendChild(this._loadingEl);\n\n    el.appendChild(searchIcon);\n    el.appendChild(this._inputEl);\n    el.appendChild(actions);\n\n    this._typeahead = new Typeahead(this._inputEl, [], {\n      filter: false,\n      minLength: this.options.minLength,\n      limit: this.options.limit\n    });\n\n    this.setRenderFunction(this.options.render);\n    this._typeahead.getItemValue = this.options.getItemValue;\n\n    this.mapMarker = null;\n    this._handleMarker = this._handleMarker.bind(this);\n    if (this._map){\n      if (this.options.trackProximity ) {\n        this._updateProximity();\n        this._map.on('moveend', this._updateProximity);\n      }\n      this._mapboxgl = this.options.mapboxgl;\n      if (!this._mapboxgl && this.options.marker) {\n        // eslint-disable-next-line no-console\n        console.error(\"No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl.\");\n        this.options.marker = false;\n      }\n    }\n    return el;\n  },\n\n  createIcon: function(name, path) {\n    var icon = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n    icon.setAttribute('class', 'mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-' + name);\n    icon.setAttribute('viewBox', '0 0 18 18');\n    icon.setAttribute('xml:space','preserve');\n    icon.setAttribute('width', 18);\n    icon.setAttribute('height', 18);\n    icon.innerHTML = path;\n    return icon;\n  },\n\n  onRemove: function() {\n    this.container.parentNode.removeChild(this.container);\n\n    if (this.options.trackProximity && this._map) {\n      this._map.off('moveend', this._updateProximity);\n    }\n\n    this._removeMarker();\n\n    this._map = null;\n\n    return this;\n  },\n\n  _onPaste: function(e){\n    var value = (e.clipboardData || window.clipboardData).getData('text');\n    if (value.length >= this.options.minLength) {\n      this._geocode(value);\n    }\n  },\n\n  _onKeyDown: function(e) {\n    var ESC_KEY_CODE = 27,\n      TAB_KEY_CODE = 9;\n\n    if (e.keyCode === ESC_KEY_CODE && this.options.clearAndBlurOnEsc) {\n      this._clear(e);\n      return this._inputEl.blur();\n    }\n\n    // if target has shadowRoot, then get the actual active element inside the shadowRoot\n    var target = e.target && e.target.shadowRoot\n      ? e.target.shadowRoot.activeElement\n      : e.target;\n    var value = target ? target.value : '';\n\n    if (!value) {\n      this.fresh = true;\n      // the user has removed all the text\n      if (e.keyCode !== TAB_KEY_CODE) this.clear(e);\n      return (this._clearEl.style.display = 'none');\n    }\n\n    // TAB, ESC, LEFT, RIGHT, ENTER, UP, DOWN\n    if ((e.metaKey || [TAB_KEY_CODE, ESC_KEY_CODE, 37, 39, 13, 38, 40].indexOf(e.keyCode) !== -1))\n      return;\n\n    if (target.value.length >= this.options.minLength) {\n      this._geocode(target.value);\n    }\n  },\n\n  _showButton: function() {\n    if (this._typeahead.selected) this._clearEl.style.display = 'block';\n  },\n\n  _hideButton: function() {\n    if (this._typeahead.selected) this._clearEl.style.display = 'none';\n  },\n\n  _onBlur: function(e) {\n    if (this.options.clearOnBlur) {\n      this._clearOnBlur(e);\n    }\n    if (this.options.collapsed) {\n      this._collapse();\n    }\n  },\n  _onChange: function() {\n    var selected = this._typeahead.selected;\n    if (selected  && JSON.stringify(selected) !== this.lastSelected) {\n      this._clearEl.style.display = 'none';\n      if (this.options.flyTo) {\n        var flyOptions;\n        if (selected.properties && !exceptions[selected.properties.short_code] && selected.bbox) {\n          var bbox = selected.bbox;\n          flyOptions = extend({}, this.options.flyTo);\n          if (this._map){\n            this._map.fitBounds([[bbox[0], bbox[1]], [bbox[2], bbox[3]]], flyOptions);\n          }\n        } else if (selected.properties && exceptions[selected.properties.short_code]) {\n          // Certain geocoder search results return (and therefore zoom to fit)\n          // an unexpectedly large bounding box: for example, both Russia and the\n          // USA span both sides of -180/180, or France includes the island of\n          // Reunion in the Indian Ocean. An incomplete list of these exceptions\n          // at ./exceptions.json provides \"reasonable\" bounding boxes as a\n          // short-term solution; this may be amended as necessary.\n          flyOptions = extend({}, this.options.flyTo);\n          if (this._map){\n            this._map.fitBounds(exceptions[selected.properties.short_code].bbox, flyOptions);\n          }\n        } else {\n          var defaultFlyOptions = {\n            zoom: this.options.zoom\n          }\n          flyOptions = extend({}, defaultFlyOptions, this.options.flyTo);\n          //  ensure that center is not overriden by custom options\n          flyOptions.center = selected.center;\n          if (this._map){\n            this._map.flyTo(flyOptions);\n          }\n        }\n      }\n      if (this.options.marker && this._mapboxgl){\n        this._handleMarker(selected);\n      }\n\n      // After selecting a feature, re-focus the textarea and set\n      // cursor at start.\n      this._inputEl.focus();\n      this._inputEl.scrollLeft = 0;\n      this._inputEl.setSelectionRange(0, 0);\n      this.lastSelected = JSON.stringify(selected);\n      this._eventEmitter.emit('result', { result: selected });\n      this.eventManager.select(selected, this);\n    }\n  },\n\n  _geocode: function(searchInput) {\n    this._loadingEl.style.display = 'block';\n    this._eventEmitter.emit('loading', { query: searchInput });\n    this.inputString = searchInput;\n    // Possible config proprerties to pass to client\n    var keys = [\n      'bbox',\n      'limit',\n      'proximity',\n      'countries',\n      'types',\n      'language',\n      'reverseMode',\n      'mode'\n    ];\n    var self = this;\n    // Create config object\n    var config = keys.reduce(function(config, key) {\n      if (self.options[key]) {\n        // countries, types, and language need to be passed in as arrays to client\n        // https://github.com/mapbox/mapbox-sdk-js/blob/master/services/geocoding.js#L38-L47\n        ['countries', 'types', 'language'].indexOf(key) > -1\n          ? (config[key] = self.options[key].split(/[\\s,]+/))\n          : (config[key] = self.options[key]);\n\n        if (key === 'proximity' && self.options[key] && self.options[key].longitude && self.options[key].latitude) {\n          config[key] = [self.options[key].longitude, self.options[key].latitude]\n        }\n      }\n      return config;\n    }, {});\n\n    var request;\n    if (this.options.localGeocoderOnly){\n      request = Promise.resolve();\n    }\n    // check if searchInput resembles coordinates, and if it does,\n    // make the request a reverseGeocode\n    else if (\n      this.options.reverseGeocode &&\n      /(-?\\d+\\.?\\d*)[, ]+(-?\\d+\\.?\\d*)[ ]*$/.test(searchInput)\n    ) {\n      // parse coordinates\n      var coords = searchInput.split(/[\\s(,)?]+/).map(function(c) {\n        return parseFloat(c, 10);\n      }).reverse();\n\n      // client only accepts one type for reverseGeocode, so\n      // use first config type if one, if not default to poi\n      config.types ? [config.types[0]] : [\"poi\"];\n      config = extend(config, { query: coords, limit: 1 });\n      request = this.geocoderService.reverseGeocode(config).send();\n    } else {\n      config = extend(config, { query: searchInput });\n      request = this.geocoderService.forwardGeocode(config).send();\n    }\n\n    var localGeocoderRes = [];\n    if (this.options.localGeocoder) {\n      localGeocoderRes = this.options.localGeocoder(searchInput);\n      if (!localGeocoderRes) {\n        localGeocoderRes = [];\n      }\n    }\n\n    request.then(\n      function(response) {\n        this._loadingEl.style.display = 'none';\n\n        var res = {};\n\n        if (!response){\n          res = {\n            type: 'FeatureCollection',\n            features: []\n          }\n        }else if (response.statusCode == '200') {\n          res = response.body;\n          res.request = response.request\n          res.headers = response.headers\n        }\n\n        res.config = config;\n        if (this.fresh){\n          this.eventManager.start(this);\n          this.fresh = false;\n        }\n        // supplement Mapbox Geocoding API results with locally populated results\n        res.features = res.features\n          ? localGeocoderRes.concat(res.features)\n          : localGeocoderRes;\n\n        // apply results filter if provided\n        if (this.options.filter && res.features.length) {\n          res.features = res.features.filter(this.options.filter);\n        }\n\n        if (res.features.length) {\n          this._clearEl.style.display = 'block';\n          this._eventEmitter.emit('results', res);\n          this._typeahead.update(res.features);\n        } else {\n          this._clearEl.style.display = 'none';\n          this._typeahead.selected = null;\n          this._renderNoResults();\n          this._eventEmitter.emit('results', res);\n        }\n\n      }.bind(this)\n    );\n\n    request.catch(\n      function(err) {\n        this._loadingEl.style.display = 'none';\n\n        // in the event of an error in the Mapbox Geocoding API still display results from the localGeocoder\n        if (localGeocoderRes.length && this.options.localGeocoder) {\n          this._clearEl.style.display = 'block';\n          this._typeahead.update(localGeocoderRes);\n        } else {\n          this._clearEl.style.display = 'none';\n          this._typeahead.selected = null;\n          this._renderError();\n        }\n\n        this._eventEmitter.emit('results', { features: localGeocoderRes });\n        this._eventEmitter.emit('error', { error: err });\n      }.bind(this)\n    );\n\n    return request;\n  },\n\n  /**\n   * Shared logic for clearing input\n   * @param {Event} [ev] the event that triggered the clear, if available\n   * @private\n   *\n   */\n  _clear: function(ev) {\n    if (ev) ev.preventDefault();\n    this._inputEl.value = '';\n    this._typeahead.selected = null;\n    this._typeahead.clear();\n    this._onChange();\n    this._clearEl.style.display = 'none';\n    this._removeMarker();\n    this.lastSelected = null;\n    this._eventEmitter.emit('clear');\n    this.fresh = true;\n  },\n\n  /**\n   * Clear and then focus the input.\n   * @param {Event} [ev] the event that triggered the clear, if available\n   *\n   */\n  clear: function(ev) {\n    this._clear(ev);\n    this._inputEl.focus();\n  },\n\n\n  /**\n   * Clear the input, without refocusing it. Used to implement clearOnBlur\n   * constructor option.\n   * @param {Event} [ev] the blur event\n   * @private\n   */\n  _clearOnBlur: function(ev) {\n    var ctx = this;\n\n    /*\n     * If relatedTarget is not found, assume user targeted the suggestions list.\n     * In that case, do not clear on blur. There are other edge cases where\n     * ev.relatedTarget could be null. Clicking on list always results in null\n     * relatedtarget because of upstream behavior in `suggestions`.\n     *\n     * The ideal solution would be to check if ev.relatedTarget is a child of\n     * the list. See issue #258 for details on why we can't do that yet.\n     */\n    if (ev.relatedTarget) {\n      ctx._clear(ev);\n    }\n  },\n\n  _onQueryResult: function(response) {\n    var results = response.body;\n    if (!results.features.length) return;\n    var result = results.features[0];\n    this._typeahead.selected = result;\n    this._inputEl.value = result.place_name;\n    this._onChange();\n  },\n\n  _updateProximity: function() {\n    // proximity is designed for local scale, if the user is looking at the whole world,\n    // it doesn't make sense to factor in the arbitrary centre of the map\n    if (!this._map){\n      return;\n    }\n    if (this._map.getZoom() > 9) {\n      var center = this._map.getCenter().wrap();\n      this.setProximity({ longitude: center.lng, latitude: center.lat });\n    } else {\n      this.setProximity(null);\n    }\n  },\n\n  _collapse: function() {\n    // do not collapse if input is in focus\n    if (!this._inputEl.value && this._inputEl !== document.activeElement) this.container.classList.add('mapboxgl-ctrl-geocoder--collapsed');\n  },\n\n  _unCollapse: function() {\n    this.container.classList.remove('mapboxgl-ctrl-geocoder--collapsed');\n  },\n\n  /**\n   * Set & query the input\n   * @param {string} searchInput location name or other search input\n   * @returns {MapboxGeocoder} this\n   */\n  query: function(searchInput) {\n    this._geocode(searchInput).then(this._onQueryResult);\n    return this;\n  },\n\n  _renderError: function(){\n    var errorMessage = \"<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>\"\n    this._renderMessage(errorMessage);\n  },\n\n  _renderNoResults: function(){\n    var errorMessage = \"<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>\";\n    this._renderMessage(errorMessage);\n  },\n\n  _renderMessage: function(msg){\n    this._typeahead.update([]);\n    this._typeahead.selected = null;\n    this._typeahead.clear();\n    this._typeahead.renderError(msg);\n  },\n\n  /**\n   * Get the text to use as the search bar placeholder\n   *\n   * If placeholder is provided in options, then use options.placeholder\n   * Otherwise, if language is provided in options, then use the localized string of the first language if available\n   * Otherwise use the default\n   *\n   * @returns {String} the value to use as the search bar placeholder\n   * @private\n   */\n  _getPlaceholderText: function(){\n    if (this.options.placeholder) return this.options.placeholder;\n    if (this.options.language){\n      var firstLanguage = this.options.language.split(\",\")[0];\n      var language = subtag.language(firstLanguage);\n      var localizedValue = localization.placeholder[language];\n      if (localizedValue)  return localizedValue;\n    }\n    return 'Search';\n  },\n\n  /**\n   * Set input\n   * @param {string} searchInput location name or other search input\n   * @returns {MapboxGeocoder} this\n   */\n  setInput: function(searchInput) {\n    // Set input value to passed value and clear everything else.\n    this._inputEl.value = searchInput;\n    this._typeahead.selected = null;\n    this._typeahead.clear();\n    this._onChange();\n    return this;\n  },\n\n  /**\n   * Set proximity\n   * @param {Object} proximity The new `options.proximity` value. This is a geographical point given as an object with `latitude` and `longitude` properties.\n   * @returns {MapboxGeocoder} this\n   */\n  setProximity: function(proximity) {\n    this.options.proximity = proximity;\n    return this;\n  },\n\n  /**\n   * Get proximity\n   * @returns {Object} The geocoder proximity\n   */\n  getProximity: function() {\n    return this.options.proximity;\n  },\n\n  /**\n   * Set the render function used in the results dropdown\n   * @param {Function} fn The function to use as a render function. This function accepts a single [Carmen GeoJSON](https://github.com/mapbox/carmen/blob/master/carmen-geojson.md) object as input and returns a string.\n   * @returns {MapboxGeocoder} this\n   */\n  setRenderFunction: function(fn){\n    if (fn && typeof(fn) == \"function\"){\n      this._typeahead.render = fn;\n    }\n    return this;\n  },\n\n  /**\n   * Get the function used to render the results dropdown\n   *\n   * @returns {Function} the render function\n   */\n  getRenderFunction: function(){\n    return this._typeahead.render;\n  },\n\n  /**\n   * Get the language to use in UI elements and when making search requests\n   *\n   * Look first at the explicitly set options otherwise use the browser's language settings\n   * @param {String} language Specify the language to use for response text and query result weighting. Options are IETF language tags comprised of a mandatory ISO 639-1 language code and optionally one or more IETF subtags for country or script. More than one value can also be specified, separated by commas.\n   * @returns {MapboxGeocoder} this\n   */\n  setLanguage: function(language){\n    var browserLocale = navigator.language || navigator.userLanguage || navigator.browserLanguage;\n    this.options.language = language || this.options.language || browserLocale;\n    return this;\n  },\n\n  /**\n   * Get the language to use in UI elements and when making search requests\n   * @returns {String} The language(s) used by the plugin, if any\n   */\n  getLanguage: function(){\n    return this.options.language;\n  },\n\n  /**\n   * Get the zoom level the map will move to when there is no bounding box on the selected result\n   * @returns {Number} the map zoom\n   */\n  getZoom: function(){\n    return this.options.zoom;\n  },\n\n  /**\n   * Set the zoom level\n   * @param {Number} zoom The zoom level that the map should animate to when a `bbox` isn't found in the response. If a `bbox` is found the map will fit to the `bbox`.\n   * @returns {MapboxGeocoder} this\n   */\n  setZoom: function(zoom){\n    this.options.zoom = zoom;\n    return this;\n  },\n\n  /**\n   * Get the parameters used to fly to the selected response, if any\n   * @returns {Boolean|Object} The `flyTo` option\n   */\n  getFlyTo: function(){\n    return this.options.flyTo;\n  },\n\n  /**\n   * Set the flyTo options\n   * @param {Boolean|Object} flyTo If false, animating the map to a selected result is disabled. If true, animating the map will use the default animation parameters. If an object, it will be passed as `options` to the map [`flyTo`](https://docs.mapbox.com/mapbox-gl-js/api/#map#flyto) or [`fitBounds`](https://docs.mapbox.com/mapbox-gl-js/api/#map#fitbounds) method providing control over the animation of the transition.\n   */\n  setFlyTo: function(flyTo){\n    this.options.flyTo = flyTo;\n    return this;\n  },\n\n  /**\n   * Get the value of the placeholder string\n   * @returns {String} The input element's placeholder value\n   */\n  getPlaceholder: function(){\n    return this.options.placeholder;\n  },\n\n  /**\n   * Set the value of the input element's placeholder\n   * @param {String} placeholder the text to use as the input element's placeholder\n   * @returns {MapboxGeocoder} this\n   */\n  setPlaceholder: function(placeholder){\n    this.placeholder = (placeholder) ? placeholder : this._getPlaceholderText();\n    this._inputEl.placeholder = this.placeholder;\n    this._inputEl.setAttribute('aria-label', this.placeholder);\n    return this\n  },\n\n  /**\n   * Get the bounding box used by the plugin\n   * @returns {Array<Number>} the bounding box, if any\n   */\n  getBbox: function(){\n    return this.options.bbox;\n  },\n\n  /**\n   * Set the bounding box to limit search results to\n   * @param {Array<Number>} bbox a bounding box given as an array in the format [minX, minY, maxX, maxY].\n   * @returns {MapboxGeocoder} this\n   */\n  setBbox: function(bbox){\n    this.options.bbox = bbox;\n    return this;\n  },\n\n  /**\n   * Get a list of the countries to limit search results to\n   * @returns {String} a comma separated list of countries to limit to, if any\n   */\n  getCountries: function(){\n    return this.options.countries;\n  },\n\n  /**\n   * Set the countries to limit search results to\n   * @param {String} countries a comma separated list of countries to limit to\n   * @returns {MapboxGeocoder} this\n   */\n  setCountries: function(countries){\n    this.options.countries = countries;\n    return this;\n  },\n\n  /**\n   * Get a list of the types to limit search results to\n   * @returns {String} a comma separated list of types to limit to\n   */\n  getTypes: function(){\n    return this.options.types;\n  },\n\n  /**\n   * Set the types to limit search results to\n   * @param {String} countries a comma separated list of types to limit to\n   * @returns {MapboxGeocoder} this\n   */\n  setTypes: function(types){\n    this.options.types = types;\n    return this;\n  },\n\n  /**\n   * Get the minimum number of characters typed to trigger results used in the plugin\n   * @returns {Number} The minimum length in characters before a search is triggered\n   */\n  getMinLength: function(){\n    return this.options.minLength;\n  },\n\n  /**\n   * Set the minimum number of characters typed to trigger results used by the plugin\n   * @param {Number} minLength the minimum length in characters\n   * @returns {MapboxGeocoder} this\n   */\n  setMinLength: function(minLength){\n    this.options.minLength = minLength;\n    if (this._typeahead)  this._typeahead.minLength = minLength;\n    return this;\n  },\n\n  /**\n   * Get the limit value for the number of results to display used by the plugin\n   * @returns {Number} The limit value for the number of results to display used by the plugin\n   */\n  getLimit: function(){\n    return this.options.limit;\n  },\n\n  /**\n   * Set the limit value for the number of results to display used by the plugin\n   * @param {Number} limit the number of search results to return\n   * @returns {MapboxGeocoder}\n   */\n  setLimit: function(limit){\n    this.options.limit = limit;\n    if (this._typeahead) this._typeahead.options.limit = limit;\n    return this;\n  },\n\n  /**\n   * Get the filter function used by the plugin\n   * @returns {Function} the filter function\n   */\n  getFilter: function(){\n    return this.options.filter;\n  },\n\n  /**\n   * Set the filter function used by the plugin.\n   * @param {Function} filter A function which accepts a Feature in the [Carmen GeoJSON](https://github.com/mapbox/carmen/blob/master/carmen-geojson.md) format to filter out results from the Geocoding API response before they are included in the suggestions list. Return `true` to keep the item, `false` otherwise.\n   * @returns {MapboxGeocoder} this\n   */\n  setFilter: function(filter){\n    this.options.filter = filter;\n    return this;\n  },\n\n  /**\n   * Set the geocoding endpoint used by the plugin.\n   * @param {Function} origin A function which accepts an HTTPS URL to specify the endpoint to query results from.\n   * @returns {MapboxGeocoder} this\n   */\n  setOrigin: function(origin){\n    this.options.origin = origin;\n    this.geocoderService = mbxGeocoder(\n      MapboxClient({\n        accessToken: this.options.accessToken,\n        origin: this.options.origin\n      })\n    );\n    return this;\n  },\n\n  /**\n   * Get the geocoding endpoint the plugin is currently set to\n   * @returns {Function} the endpoint URL\n   */\n  getOrigin: function(){\n    return this.options.origin;\n  },\n\n  /**\n   * Handle the placement of a result marking the selected result\n   * @private\n   * @param {Object} selected the selected geojson feature\n   * @returns {MapboxGeocoder} this\n   */\n  _handleMarker: function(selected){\n    // clean up any old marker that might be present\n    if (!this._map){\n      return;\n    }\n    this._removeMarker();\n    var defaultMarkerOptions = {\n      color: '#4668F2'\n    }\n    var markerOptions = extend({}, defaultMarkerOptions, this.options.marker)\n    this.mapMarker = new this._mapboxgl.Marker(markerOptions);\n    if (selected.center) {\n      this.mapMarker\n        .setLngLat(selected.center)\n        .addTo(this._map);\n    } else if (selected.geometry && selected.geometry.type && selected.geometry.type === 'Point' && selected.geometry.coordinates) {\n      this.mapMarker\n        .setLngLat(selected.geometry.coordinates)\n        .addTo(this._map);\n    }\n    return this;\n  },\n\n  /**\n   * Handle the removal of a result marker\n   * @private\n   */\n  _removeMarker: function(){\n    if (this.mapMarker){\n      this.mapMarker.remove();\n      this.mapMarker = null;\n    }\n  },\n\n  /**\n   * Subscribe to events that happen within the plugin.\n   * @param {String} type name of event. Available events and the data passed into their respective event objects are:\n   *\n   * - __clear__ `Emitted when the input is cleared`\n   * - __loading__ `{ query } Emitted when the geocoder is looking up a query`\n   * - __results__ `{ results } Fired when the geocoder returns a response`\n   * - __result__ `{ result } Fired when input is set`\n   * - __error__ `{ error } Error as string`\n   * @param {Function} fn function that's called when the event is emitted.\n   * @returns {MapboxGeocoder} this;\n   */\n  on: function(type, fn) {\n    this._eventEmitter.on(type, fn);\n    return this;\n  },\n\n  /**\n   * Remove an event\n   * @returns {MapboxGeocoder} this\n   * @param {String} type Event name.\n   * @param {Function} fn Function that should unsubscribe to the event emitted.\n   */\n  off: function(type, fn) {\n    this._eventEmitter.removeListener(type, fn);\n    this.eventManager.remove();\n    return this;\n  }\n};\n\nmodule.exports = MapboxGeocoder;\n","'use strict';\n\n/**\n * A typeahead component for inputs\n * @class Suggestions\n *\n * @param {HTMLInputElement} el A valid HTML input element\n * @param {Array} data An array of data used for results\n * @param {Object} options\n * @param {Number} [options.limit=5] Max number of results to display in the auto suggest list.\n * @param {Number} [options.minLength=2] Number of characters typed into an input to trigger suggestions.\n * @param {Boolean} [options.hideOnBlur=true] If `true`, hides the suggestions when focus is lost.\n * @return {Suggestions} `this`\n * @example\n * // in the browser\n * var input = document.querySelector('input');\n * var data = [\n *   'Roy Eldridge',\n *   'Roy Hargrove',\n *   'Rex Stewart'\n * ];\n *\n * new Suggestions(input, data);\n *\n * // with options\n * var input = document.querySelector('input');\n * var data = [{\n *   name: 'Roy Eldridge',\n *   year: 1911\n * }, {\n *   name: 'Roy Hargrove',\n *   year: 1969\n * }, {\n *   name: 'Rex Stewart',\n *   year: 1907\n * }];\n *\n * var typeahead = new Suggestions(input, data, {\n *   filter: false, // Disable filtering\n *   minLength: 3, // Number of characters typed into an input to trigger suggestions.\n *   limit: 3, //  Max number of results to display.\n *   hideOnBlur: false // Don't hide results when input loses focus\n * });\n *\n * // As we're passing an object of an arrays as data, override\n * // `getItemValue` by specifying the specific property to search on.\n * typeahead.getItemValue = function(item) { return item.name };\n *\n * input.addEventListener('change', function() {\n *   console.log(typeahead.selected); // Current selected item.\n * });\n *\n * // With browserify\n * var Suggestions = require('suggestions');\n *\n * new Suggestions(input, data);\n */\nvar Suggestions = require('./src/suggestions');\nwindow.Suggestions = module.exports = Suggestions;\n","'use strict';\n\nvar extend = require('xtend');\nvar fuzzy = require('fuzzy');\nvar List = require('./list');\n\nvar Suggestions = function(el, data, options) {\n  options = options || {};\n\n  this.options = extend({\n    minLength: 2,\n    limit: 5,\n    filter: true,\n    hideOnBlur: true\n  }, options);\n\n  this.el = el;\n  this.data = data || [];\n  this.list = new List(this);\n\n  this.query = '';\n  this.selected = null;\n\n  this.list.draw();\n\n  this.el.addEventListener('keyup', function(e) {\n    this.handleKeyUp(e.keyCode);\n  }.bind(this), false);\n\n  this.el.addEventListener('keydown', function(e) {\n    this.handleKeyDown(e);\n  }.bind(this));\n\n  this.el.addEventListener('focus', function() {\n    this.handleFocus();\n  }.bind(this));\n\n  this.el.addEventListener('blur', function() {\n    this.handleBlur();\n  }.bind(this));\n\n  this.el.addEventListener('paste', function(e) {\n    this.handlePaste(e);\n  }.bind(this));\n\n  // use user-provided render function if given, otherwise just use the default\n  this.render = (this.options.render) ? this.options.render.bind(this) : this.render.bind(this)\n\n  this.getItemValue = (this.options.getItemValue) ? this.options.getItemValue.bind(this) : this.getItemValue.bind(this);\n\n  return this;\n};\n\nSuggestions.prototype.handleKeyUp = function(keyCode) {\n  // 40 - DOWN\n  // 38 - UP\n  // 27 - ESC\n  // 13 - ENTER\n  // 9 - TAB\n\n  if (keyCode === 40 ||\n      keyCode === 38 ||\n      keyCode === 27 ||\n      keyCode === 13 ||\n      keyCode === 9) return;\n\n  this.handleInputChange(this.el.value);\n};\n\nSuggestions.prototype.handleKeyDown = function(e) {\n  switch (e.keyCode) {\n    case 13: // ENTER\n    case 9: // TAB\n      if (!this.list.isEmpty()) {\n        if (this.list.isVisible()) {\n          e.preventDefault();\n        }\n        this.value(this.list.items[this.list.active].original);\n        this.list.hide();\n      }\n    break;\n    case 27: // ESC\n      if (!this.list.isEmpty()) this.list.hide();\n    break;\n    case 38: // UP\n      this.list.previous();\n    break;\n    case 40: // DOWN\n      this.list.next();\n    break;\n  }\n};\n\nSuggestions.prototype.handleBlur = function() {\n  if (!this.list.selectingListItem && this.options.hideOnBlur) {\n    this.list.hide();\n  }\n};\n\nSuggestions.prototype.handlePaste = function(e) {\n  if (e.clipboardData) {\n    this.handleInputChange(e.clipboardData.getData('Text'));\n  } else {\n    var self = this;\n    setTimeout(function () {\n      self.handleInputChange(e.target.value);\n    }, 100);\n  }\n};\n\nSuggestions.prototype.handleInputChange = function(query) {\n  this.query = this.normalize(query);\n\n  this.list.clear();\n\n  if (this.query.length < this.options.minLength) {\n    this.list.draw();\n    return;\n  }\n\n  this.getCandidates(function(data) {\n    for (var i = 0; i < data.length; i++) {\n      this.list.add(data[i]);\n      if (i === (this.options.limit - 1)) break;\n    }\n    this.list.draw();\n  }.bind(this));\n};\n\nSuggestions.prototype.handleFocus = function() {\n  if (!this.list.isEmpty()) this.list.show();\n  this.list.selectingListItem = false;\n};\n\n/**\n * Update data previously passed\n *\n * @param {Array} revisedData\n */\nSuggestions.prototype.update = function(revisedData) {\n  this.data = revisedData;\n  this.handleKeyUp();\n};\n\n/**\n * Clears data\n */\nSuggestions.prototype.clear = function() {\n  this.data = [];\n  this.list.clear();\n};\n\n/**\n * Normalize the results list and input value for matching\n *\n * @param {String} value\n * @return {String}\n */\nSuggestions.prototype.normalize = function(value) {\n  value = value.toLowerCase();\n  return value;\n};\n\n/**\n * Evaluates whether an array item qualifies as a match with the current query\n *\n * @param {String} candidate a possible item from the array passed\n * @param {String} query the current query\n * @return {Boolean}\n */\nSuggestions.prototype.match = function(candidate, query) {\n  return candidate.indexOf(query) > -1;\n};\n\nSuggestions.prototype.value = function(value) {\n  this.selected = value;\n  this.el.value = this.getItemValue(value);\n\n  if (document.createEvent) {\n    var e = document.createEvent('HTMLEvents');\n    e.initEvent('change', true, false);\n    this.el.dispatchEvent(e);\n  } else {\n    this.el.fireEvent('onchange');\n  }\n};\n\nSuggestions.prototype.getCandidates = function(callback) {\n  var options = {\n    pre: '<strong>',\n    post: '</strong>',\n    extract: function(d) { return this.getItemValue(d); }.bind(this)\n  };\n  var results;\n  if(this.options.filter){\n    results = fuzzy.filter(this.query, this.data, options);\n\n    results = results.map(function(item){\n      return {\n        original: item.original,\n        string: this.render(item.original, item.string)\n      };\n    }.bind(this))\n  }else{\n    results = this.data.map(function(d) {\n      var renderedString = this.render(d);\n      return {\n        original: d,\n        string: renderedString\n      };\n    }.bind(this));\n  }\n  callback(results);\n};\n\n/**\n * For a given item in the data array, return what should be used as the candidate string\n *\n * @param {Object|String} item an item from the data array\n * @return {String} item\n */\nSuggestions.prototype.getItemValue = function(item) {\n  return item;\n};\n\n/**\n * For a given item in the data array, return a string of html that should be rendered in the dropdown\n * @param {Object|String} item an item from the data array\n * @param {String} sourceFormatting a string that has pre-formatted html that should be passed directly through the render function \n * @return {String} html\n */\nSuggestions.prototype.render = function(item, sourceFormatting) {\n  if (sourceFormatting){\n    // use existing formatting on the source string\n    return sourceFormatting;\n  }\n  var boldString = (item.original) ? this.getItemValue(item.original) : this.getItemValue(item);\n  var indexString = this.normalize(boldString);\n  var indexOfQuery = indexString.lastIndexOf(this.query);\n  while (indexOfQuery > -1) {\n    var endIndexOfQuery = indexOfQuery + this.query.length;\n    boldString = boldString.slice(0, indexOfQuery) + '<strong>' + boldString.slice(indexOfQuery, endIndexOfQuery) + '</strong>' + boldString.slice(endIndexOfQuery);\n    indexOfQuery = indexString.slice(0, indexOfQuery).lastIndexOf(this.query);\n  }\n  return boldString\n}\n\n/**\n * Render an custom error message in the suggestions list\n * @param {String} msg An html string to render as an error message\n */\nSuggestions.prototype.renderError = function(msg){\n  this.list.drawError(msg);\n}\n\nmodule.exports = Suggestions;\n","/*\n * Fuzzy\n * https://github.com/myork/fuzzy\n *\n * Copyright (c) 2012 Matt York\n * Licensed under the MIT license.\n */\n\n(function() {\n\nvar root = this;\n\nvar fuzzy = {};\n\n// Use in node or in browser\nif (typeof exports !== 'undefined') {\n  module.exports = fuzzy;\n} else {\n  root.fuzzy = fuzzy;\n}\n\n// Return all elements of `array` that have a fuzzy\n// match against `pattern`.\nfuzzy.simpleFilter = function(pattern, array) {\n  return array.filter(function(str) {\n    return fuzzy.test(pattern, str);\n  });\n};\n\n// Does `pattern` fuzzy match `str`?\nfuzzy.test = function(pattern, str) {\n  return fuzzy.match(pattern, str) !== null;\n};\n\n// If `pattern` matches `str`, wrap each matching character\n// in `opts.pre` and `opts.post`. If no match, return null\nfuzzy.match = function(pattern, str, opts) {\n  opts = opts || {};\n  var patternIdx = 0\n    , result = []\n    , len = str.length\n    , totalScore = 0\n    , currScore = 0\n    // prefix\n    , pre = opts.pre || ''\n    // suffix\n    , post = opts.post || ''\n    // String to compare against. This might be a lowercase version of the\n    // raw string\n    , compareString =  opts.caseSensitive && str || str.toLowerCase()\n    , ch;\n\n  pattern = opts.caseSensitive && pattern || pattern.toLowerCase();\n\n  // For each character in the string, either add it to the result\n  // or wrap in template if it's the next string in the pattern\n  for(var idx = 0; idx < len; idx++) {\n    ch = str[idx];\n    if(compareString[idx] === pattern[patternIdx]) {\n      ch = pre + ch + post;\n      patternIdx += 1;\n\n      // consecutive characters should increase the score more than linearly\n      currScore += 1 + currScore;\n    } else {\n      currScore = 0;\n    }\n    totalScore += currScore;\n    result[result.length] = ch;\n  }\n\n  // return rendered string if we have a match for every char\n  if(patternIdx === pattern.length) {\n    // if the string is an exact match with pattern, totalScore should be maxed\n    totalScore = (compareString === pattern) ? Infinity : totalScore;\n    return {rendered: result.join(''), score: totalScore};\n  }\n\n  return null;\n};\n\n// The normal entry point. Filters `arr` for matches against `pattern`.\n// It returns an array with matching values of the type:\n//\n//     [{\n//         string:   '<b>lah' // The rendered string\n//       , index:    2        // The index of the element in `arr`\n//       , original: 'blah'   // The original element in `arr`\n//     }]\n//\n// `opts` is an optional argument bag. Details:\n//\n//    opts = {\n//        // string to put before a matching character\n//        pre:     '<b>'\n//\n//        // string to put after matching character\n//      , post:    '</b>'\n//\n//        // Optional function. Input is an entry in the given arr`,\n//        // output should be the string to test `pattern` against.\n//        // In this example, if `arr = [{crying: 'koala'}]` we would return\n//        // 'koala'.\n//      , extract: function(arg) { return arg.crying; }\n//    }\nfuzzy.filter = function(pattern, arr, opts) {\n  if(!arr || arr.length === 0) {\n    return [];\n  }\n  if (typeof pattern !== 'string') {\n    return arr;\n  }\n  opts = opts || {};\n  return arr\n    .reduce(function(prev, element, idx, arr) {\n      var str = element;\n      if(opts.extract) {\n        str = opts.extract(element);\n      }\n      var rendered = fuzzy.match(pattern, str, opts);\n      if(rendered != null) {\n        prev[prev.length] = {\n            string: rendered.rendered\n          , score: rendered.score\n          , index: idx\n          , original: element\n        };\n      }\n      return prev;\n    }, [])\n\n    // Sort by score. Browsers are inconsistent wrt stable/unstable\n    // sorting, so force stable by using the index in the case of tie.\n    // See http://ofb.net/~sethml/is-sort-stable.html\n    .sort(function(a,b) {\n      var compare = b.score - a.score;\n      if(compare) return compare;\n      return a.index - b.index;\n    });\n};\n\n\n}());\n\n","'use strict';\n\nvar List = function(component) {\n  this.component = component;\n  this.items = [];\n  this.active = 0;\n  this.wrapper = document.createElement('div');\n  this.wrapper.className = 'suggestions-wrapper';\n  this.element = document.createElement('ul');\n  this.element.className = 'suggestions';\n  this.wrapper.appendChild(this.element);\n\n  // selectingListItem is set to true in the time between the mousedown and mouseup when clicking an item in the list\n  // mousedown on a list item will cause the input to blur which normally hides the list, so this flag is used to keep\n  // the list open until the mouseup\n  this.selectingListItem = false;\n\n  component.el.parentNode.insertBefore(this.wrapper, component.el.nextSibling);\n  return this;\n};\n\nList.prototype.show = function() {\n  this.element.style.display = 'block';\n};\n\nList.prototype.hide = function() {\n  this.element.style.display = 'none';\n};\n\nList.prototype.add = function(item) {\n  this.items.push(item);\n};\n\nList.prototype.clear = function() {\n  this.items = [];\n  this.active = 0;\n};\n\nList.prototype.isEmpty = function() {\n  return !this.items.length;\n};\n\nList.prototype.isVisible = function() {\n  return this.element.style.display === 'block';\n};\n\nList.prototype.draw = function() {\n  this.element.innerHTML = '';\n\n  if (this.items.length === 0) {\n    this.hide();\n    return;\n  }\n\n  for (var i = 0; i < this.items.length; i++) {\n    this.drawItem(this.items[i], this.active === i);\n  }\n\n  this.show();\n};\n\nList.prototype.drawItem = function(item, active) {\n  var li = document.createElement('li'),\n    a = document.createElement('a');\n\n  if (active) li.className += ' active';\n\n  a.innerHTML = item.string;\n\n  li.appendChild(a);\n  this.element.appendChild(li);\n\n  li.addEventListener('mousedown', function() {\n    this.selectingListItem = true;\n  }.bind(this));\n\n  li.addEventListener('mouseup', function() {\n    this.handleMouseUp.call(this, item);\n  }.bind(this));\n};\n\nList.prototype.handleMouseUp = function(item) {\n  this.selectingListItem = false;\n  this.component.value(item.original);\n  this.clear();\n  this.draw();\n};\n\nList.prototype.move = function(index) {\n  this.active = index;\n  this.draw();\n};\n\nList.prototype.previous = function() {\n  this.move(this.active === 0 ? this.items.length - 1 : this.active - 1);\n};\n\nList.prototype.next = function() {\n  this.move(this.active === this.items.length - 1 ? 0 : this.active + 1);\n};\n\nList.prototype.drawError = function(msg){\n  var li = document.createElement('li');\n\n  li.innerHTML = msg;\n\n  this.element.appendChild(li);\n  this.show();\n}\n\nmodule.exports = List;\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = debounce;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","module.exports = {\n  'fr': {\n    'name': 'France',\n    'bbox': [[-4.59235, 41.380007], [9.560016, 51.148506]]\n  },\n  'us': {\n    'name': 'United States',\n    'bbox': [[-171.791111, 18.91619], [-66.96466, 71.357764]]\n  },\n  'ru': {\n    'name': 'Russia',\n    'bbox': [[19.66064, 41.151416], [190.10042, 81.2504]]\n  },\n  'ca': {\n    'name': 'Canada',\n    'bbox': [[-140.99778, 41.675105], [-52.648099, 83.23324]]\n  }\n};\n","'use strict';\n\nvar client = require('./lib/client');\n\nmodule.exports = client;\n","'use strict';\n\nvar MapiResponse = require('../classes/mapi-response');\nvar MapiError = require('../classes/mapi-error');\nvar constants = require('../constants');\nvar parseHeaders = require('../helpers/parse-headers');\n\n// Keys are request IDs, values are XHRs.\nvar requestsUnderway = {};\n\nfunction browserAbort(request) {\n  var xhr = requestsUnderway[request.id];\n  if (!xhr) return;\n  xhr.abort();\n  delete requestsUnderway[request.id];\n}\n\nfunction createResponse(request, xhr) {\n  return new MapiResponse(request, {\n    body: xhr.response,\n    headers: parseHeaders(xhr.getAllResponseHeaders()),\n    statusCode: xhr.status\n  });\n}\n\nfunction normalizeBrowserProgressEvent(event) {\n  var total = event.total;\n  var transferred = event.loaded;\n  var percent = (100 * transferred) / total;\n  return {\n    total: total,\n    transferred: transferred,\n    percent: percent\n  };\n}\n\nfunction sendRequestXhr(request, xhr) {\n  return new Promise(function(resolve, reject) {\n    xhr.onprogress = function(event) {\n      request.emitter.emit(\n        constants.EVENT_PROGRESS_DOWNLOAD,\n        normalizeBrowserProgressEvent(event)\n      );\n    };\n\n    var file = request.file;\n    if (file) {\n      xhr.upload.onprogress = function(event) {\n        request.emitter.emit(\n          constants.EVENT_PROGRESS_UPLOAD,\n          normalizeBrowserProgressEvent(event)\n        );\n      };\n    }\n\n    xhr.onerror = function(error) {\n      reject(error);\n    };\n\n    xhr.onabort = function() {\n      var mapiError = new MapiError({\n        request: request,\n        type: constants.ERROR_REQUEST_ABORTED\n      });\n      reject(mapiError);\n    };\n\n    xhr.onload = function() {\n      delete requestsUnderway[request.id];\n      if (xhr.status < 200 || xhr.status >= 400) {\n        var mapiError = new MapiError({\n          request: request,\n          body: xhr.response,\n          statusCode: xhr.status\n        });\n        reject(mapiError);\n        return;\n      }\n      resolve(xhr);\n    };\n\n    var body = request.body;\n\n    // matching service needs to send a www-form-urlencoded request\n    if (typeof body === 'string') {\n      xhr.send(body);\n    } else if (body) {\n      xhr.send(JSON.stringify(body));\n    } else if (file) {\n      xhr.send(file);\n    } else {\n      xhr.send();\n    }\n\n    requestsUnderway[request.id] = xhr;\n  }).then(function(xhr) {\n    return createResponse(request, xhr);\n  });\n}\n\n// The accessToken argument gives this function flexibility\n// for Mapbox's internal client.\nfunction createRequestXhr(request, accessToken) {\n  var url = request.url(accessToken);\n  var xhr = new window.XMLHttpRequest();\n  xhr.open(request.method, url);\n  Object.keys(request.headers).forEach(function(key) {\n    xhr.setRequestHeader(key, request.headers[key]);\n  });\n  return xhr;\n}\n\nfunction browserSend(request) {\n  return Promise.resolve().then(function() {\n    var xhr = createRequestXhr(request, request.client.accessToken);\n    return sendRequestXhr(request, xhr);\n  });\n}\n\nmodule.exports = {\n  browserAbort: browserAbort,\n  sendRequestXhr: sendRequestXhr,\n  browserSend: browserSend,\n  createRequestXhr: createRequestXhr\n};\n","'use strict';\n\nvar parseLinkHeader = require('../helpers/parse-link-header');\n\n/**\n * A Mapbox API response.\n *\n * @class MapiResponse\n * @property {Object} body - The response body, parsed as JSON.\n * @property {string} rawBody - The raw response body.\n * @property {number} statusCode - The response's status code.\n * @property {Object} headers - The parsed response headers.\n * @property {Object} links - The parsed response links.\n * @property {MapiRequest} request - The response's originating `MapiRequest`.\n */\n\n/**\n * @ignore\n * @param {MapiRequest} request\n * @param {Object} responseData\n * @param {Object} responseData.headers\n * @param {string} responseData.body\n * @param {number} responseData.statusCode\n */\nfunction MapiResponse(request, responseData) {\n  this.request = request;\n  this.headers = responseData.headers;\n  this.rawBody = responseData.body;\n  this.statusCode = responseData.statusCode;\n  try {\n    this.body = JSON.parse(responseData.body || '{}');\n  } catch (parseError) {\n    this.body = responseData.body;\n  }\n  this.links = parseLinkHeader(this.headers.link);\n}\n\n/**\n * Check if there is a next page that you can fetch.\n *\n * @returns {boolean}\n */\nMapiResponse.prototype.hasNextPage = function hasNextPage() {\n  return !!this.links.next;\n};\n\n/**\n * Create a request for the next page, if there is one.\n * If there is no next page, returns `null`.\n *\n * @returns {MapiRequest | null}\n */\nMapiResponse.prototype.nextPage = function nextPage() {\n  if (!this.hasNextPage()) return null;\n  return this.request._extend({\n    path: this.links.next.url\n  });\n};\n\nmodule.exports = MapiResponse;\n","'use strict';\n\n// Like https://github.com/thlorenz/lib/parse-link-header but without any\n// additional dependencies.\n\nfunction parseParam(param) {\n  var parts = param.match(/\\s*(.+)\\s*=\\s*\"?([^\"]+)\"?/);\n  if (!parts) return null;\n\n  return {\n    key: parts[1],\n    value: parts[2]\n  };\n}\n\nfunction parseLink(link) {\n  var parts = link.match(/<?([^>]*)>(.*)/);\n  if (!parts) return null;\n\n  var linkUrl = parts[1];\n  var linkParams = parts[2].split(';');\n  var rel = null;\n  var parsedLinkParams = linkParams.reduce(function(result, param) {\n    var parsed = parseParam(param);\n    if (!parsed) return result;\n    if (parsed.key === 'rel') {\n      if (!rel) {\n        rel = parsed.value;\n      }\n      return result;\n    }\n    result[parsed.key] = parsed.value;\n    return result;\n  }, {});\n  if (!rel) return null;\n\n  return {\n    url: linkUrl,\n    rel: rel,\n    params: parsedLinkParams\n  };\n}\n\n/**\n * Parse a Link header.\n *\n * @param {string} linkHeader\n * @returns {{\n *   [string]: {\n *     url: string,\n *     params: { [string]: string }\n *   }\n * }}\n */\nfunction parseLinkHeader(linkHeader) {\n  if (!linkHeader) return {};\n\n  return linkHeader.split(/,\\s*</).reduce(function(result, link) {\n    var parsed = parseLink(link);\n    if (!parsed) return result;\n    // rel value can be multiple whitespace-separated rels.\n    var splitRel = parsed.rel.split(/\\s+/);\n    splitRel.forEach(function(rel) {\n      if (!result[rel]) {\n        result[rel] = {\n          url: parsed.url,\n          params: parsed.params\n        };\n      }\n    });\n    return result;\n  }, {});\n}\n\nmodule.exports = parseLinkHeader;\n","'use strict';\n\nvar constants = require('../constants');\n\n/**\n * A Mapbox API error.\n *\n * If there's an error during the API transaction,\n * the Promise returned by `MapiRequest`'s [`send`](#send)\n * method should reject with a `MapiError`.\n *\n * @class MapiError\n * @hideconstructor\n * @property {MapiRequest} request - The errored request.\n * @property {string} type - The type of error. Usually this is `'HttpError'`.\n *   If the request was aborted, so the error was\n *   not sent from the server, the type will be\n *   `'RequestAbortedError'`.\n * @property {number} [statusCode] - The numeric status code of\n *   the HTTP response.\n * @property {Object | string} [body] - If the server sent a response body,\n *   this property exposes that response, parsed as JSON if possible.\n * @property {string} [message] - Whatever message could be derived from the\n *   call site and HTTP response.\n *\n * @param {MapiRequest} options.request\n * @param {number} [options.statusCode]\n * @param {string} [options.body]\n * @param {string} [options.message]\n * @param {string} [options.type]\n */\nfunction MapiError(options) {\n  var errorType = options.type || constants.ERROR_HTTP;\n\n  var body;\n  if (options.body) {\n    try {\n      body = JSON.parse(options.body);\n    } catch (e) {\n      body = options.body;\n    }\n  } else {\n    body = null;\n  }\n\n  var message = options.message || null;\n  if (!message) {\n    if (typeof body === 'string') {\n      message = body;\n    } else if (body && typeof body.message === 'string') {\n      message = body.message;\n    } else if (errorType === constants.ERROR_REQUEST_ABORTED) {\n      message = 'Request aborted';\n    }\n  }\n\n  this.message = message;\n  this.type = errorType;\n  this.statusCode = options.statusCode || null;\n  this.request = options.request;\n  this.body = body;\n}\n\nmodule.exports = MapiError;\n","'use strict';\n\nfunction parseSingleHeader(raw) {\n  var boundary = raw.indexOf(':');\n  var name = raw\n    .substring(0, boundary)\n    .trim()\n    .toLowerCase();\n  var value = raw.substring(boundary + 1).trim();\n  return {\n    name: name,\n    value: value\n  };\n}\n\n/**\n * Parse raw headers into an object with lowercase properties.\n * Does not fully parse headings into more complete data structure,\n * as larger libraries might do. Also does not deal with duplicate\n * headers because Node doesn't seem to deal with those well, so\n * we shouldn't let the browser either, for consistency.\n *\n * @param {string} raw\n * @returns {Object}\n */\nfunction parseHeaders(raw) {\n  var headers = {};\n  if (!raw) {\n    return headers;\n  }\n\n  raw\n    .trim()\n    .split(/[\\r|\\n]+/)\n    .forEach(function(rawHeader) {\n      var parsed = parseSingleHeader(rawHeader);\n      headers[parsed.name] = parsed.value;\n    });\n\n  return headers;\n}\n\nmodule.exports = parseHeaders;\n","/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */\n;(function(root) {\n\n\t// Detect free variables `exports`.\n\tvar freeExports = typeof exports == 'object' && exports;\n\n\t// Detect free variable `module`.\n\tvar freeModule = typeof module == 'object' && module &&\n\t\tmodule.exports == freeExports && module;\n\n\t// Detect free variable `global`, from Node.js or Browserified code, and use\n\t// it as `root`.\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {\n\t\troot = freeGlobal;\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\tvar InvalidCharacterError = function(message) {\n\t\tthis.message = message;\n\t};\n\tInvalidCharacterError.prototype = new Error;\n\tInvalidCharacterError.prototype.name = 'InvalidCharacterError';\n\n\tvar error = function(message) {\n\t\t// Note: the error messages used throughout this file match those used by\n\t\t// the native `atob`/`btoa` implementation in Chromium.\n\t\tthrow new InvalidCharacterError(message);\n\t};\n\n\tvar TABLE = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\t// http://whatwg.org/html/common-microsyntaxes.html#space-character\n\tvar REGEX_SPACE_CHARACTERS = /[\\t\\n\\f\\r ]/g;\n\n\t// `decode` is designed to be fully compatible with `atob` as described in the\n\t// HTML Standard. http://whatwg.org/html/webappapis.html#dom-windowbase64-atob\n\t// The optimized base64-decoding algorithm used is based on @atks excellent\n\t// implementation. https://gist.github.com/atk/1020396\n\tvar decode = function(input) {\n\t\tinput = String(input)\n\t\t\t.replace(REGEX_SPACE_CHARACTERS, '');\n\t\tvar length = input.length;\n\t\tif (length % 4 == 0) {\n\t\t\tinput = input.replace(/==?$/, '');\n\t\t\tlength = input.length;\n\t\t}\n\t\tif (\n\t\t\tlength % 4 == 1 ||\n\t\t\t// http://whatwg.org/C#alphanumeric-ascii-characters\n\t\t\t/[^+a-zA-Z0-9/]/.test(input)\n\t\t) {\n\t\t\terror(\n\t\t\t\t'Invalid character: the string to be decoded is not correctly encoded.'\n\t\t\t);\n\t\t}\n\t\tvar bitCounter = 0;\n\t\tvar bitStorage;\n\t\tvar buffer;\n\t\tvar output = '';\n\t\tvar position = -1;\n\t\twhile (++position < length) {\n\t\t\tbuffer = TABLE.indexOf(input.charAt(position));\n\t\t\tbitStorage = bitCounter % 4 ? bitStorage * 64 + buffer : buffer;\n\t\t\t// Unless this is the first of a group of 4 characters\n\t\t\tif (bitCounter++ % 4) {\n\t\t\t\t// convert the first 8 bits to a single ASCII character.\n\t\t\t\toutput += String.fromCharCode(\n\t\t\t\t\t0xFF & bitStorage >> (-2 * bitCounter & 6)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t};\n\n\t// `encode` is designed to be fully compatible with `btoa` as described in the\n\t// HTML Standard: http://whatwg.org/html/webappapis.html#dom-windowbase64-btoa\n\tvar encode = function(input) {\n\t\tinput = String(input);\n\t\tif (/[^\\0-\\xFF]/.test(input)) {\n\t\t\t// Note: no need to special-case astral symbols here, as surrogates are\n\t\t\t// matched, and the input is supposed to only contain ASCII anyway.\n\t\t\terror(\n\t\t\t\t'The string to be encoded contains characters outside of the ' +\n\t\t\t\t'Latin1 range.'\n\t\t\t);\n\t\t}\n\t\tvar padding = input.length % 3;\n\t\tvar output = '';\n\t\tvar position = -1;\n\t\tvar a;\n\t\tvar b;\n\t\tvar c;\n\t\tvar d;\n\t\tvar buffer;\n\t\t// Make sure any padding is handled outside of the loop.\n\t\tvar length = input.length - padding;\n\n\t\twhile (++position < length) {\n\t\t\t// Read three bytes, i.e. 24 bits.\n\t\t\ta = input.charCodeAt(position) << 16;\n\t\t\tb = input.charCodeAt(++position) << 8;\n\t\t\tc = input.charCodeAt(++position);\n\t\t\tbuffer = a + b + c;\n\t\t\t// Turn the 24 bits into four chunks of 6 bits each, and append the\n\t\t\t// matching character for each of them to the output.\n\t\t\toutput += (\n\t\t\t\tTABLE.charAt(buffer >> 18 & 0x3F) +\n\t\t\t\tTABLE.charAt(buffer >> 12 & 0x3F) +\n\t\t\t\tTABLE.charAt(buffer >> 6 & 0x3F) +\n\t\t\t\tTABLE.charAt(buffer & 0x3F)\n\t\t\t);\n\t\t}\n\n\t\tif (padding == 2) {\n\t\t\ta = input.charCodeAt(position) << 8;\n\t\t\tb = input.charCodeAt(++position);\n\t\t\tbuffer = a + b;\n\t\t\toutput += (\n\t\t\t\tTABLE.charAt(buffer >> 10) +\n\t\t\t\tTABLE.charAt((buffer >> 4) & 0x3F) +\n\t\t\t\tTABLE.charAt((buffer << 2) & 0x3F) +\n\t\t\t\t'='\n\t\t\t);\n\t\t} else if (padding == 1) {\n\t\t\tbuffer = input.charCodeAt(position);\n\t\t\toutput += (\n\t\t\t\tTABLE.charAt(buffer >> 2) +\n\t\t\t\tTABLE.charAt((buffer << 4) & 0x3F) +\n\t\t\t\t'=='\n\t\t\t);\n\t\t}\n\n\t\treturn output;\n\t};\n\n\tvar base64 = {\n\t\t'encode': encode,\n\t\t'decode': decode,\n\t\t'version': '0.1.0'\n\t};\n\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine(function() {\n\t\t\treturn base64;\n\t\t});\n\t}\telse if (freeExports && !freeExports.nodeType) {\n\t\tif (freeModule) { // in Node.js or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = base64;\n\t\t} else { // in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (var key in base64) {\n\t\t\t\tbase64.hasOwnProperty(key) && (freeExports[key] = base64[key]);\n\t\t\t}\n\t\t}\n\t} else { // in Rhino or a web browser\n\t\troot.base64 = base64;\n\t}\n\n}(this));\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","'use strict';\n\nvar parseToken = require('@mapbox/parse-mapbox-token');\nvar xtend = require('xtend');\nvar EventEmitter = require('eventemitter3');\nvar urlUtils = require('../helpers/url-utils');\nvar constants = require('../constants');\n\nvar requestId = 1;\n\n/**\n * A Mapbox API request.\n *\n * Note that creating a `MapiRequest` does *not* send the request automatically.\n * Use the request's `send` method to send it off and get a `Promise`.\n *\n * The `emitter` property is an `EventEmitter` that emits the following events:\n *\n * - `'response'` - Listeners will be called with a `MapiResponse`.\n * - `'error'` - Listeners will be called with a `MapiError`.\n * - `'downloadProgress'` - Listeners will be called with `ProgressEvents`.\n * - `'uploadProgress'` - Listeners will be called with `ProgressEvents`.\n *   Upload events are only available when the request includes a file.\n *\n * @class MapiRequest\n * @property {EventEmitter} emitter - An event emitter. See above.\n * @property {MapiClient} client - This request's `MapiClient`.\n * @property {MapiResponse|null} response - If this request has been sent and received\n *   a response, the response is available on this property.\n * @property {MapiError|Error|null} error - If this request has been sent and\n *   received an error in response, the error is available on this property.\n * @property {boolean} aborted - If the request has been aborted\n *   (via [`abort`](#abort)), this property will be `true`.\n * @property {boolean} sent - If the request has been sent, this property will\n *   be `true`. You cannot send the same request twice, so if you need to create\n *   a new request that is the equivalent of an existing one, use\n *   [`clone`](#clone).\n * @property {string} path - The request's path, including colon-prefixed route\n *   parameters.\n * @property {string} origin - The request's origin.\n * @property {string} method - The request's HTTP method.\n * @property {Object} query - A query object, which will be transformed into\n *   a URL query string.\n * @property {Object} params - A route parameters object, whose values will\n *   be interpolated the path.\n * @property {Object} headers - The request's headers.\n * @property {Object|string|null} body - Data to send with the request.\n *   If the request has a body, it will also be sent with the header\n *   `'Content-Type: application/json'`.\n * @property {Blob|ArrayBuffer|string|ReadStream} file - A file to\n *   send with the request. The browser client accepts Blobs and ArrayBuffers;\n *   the Node client accepts strings (filepaths) and ReadStreams.\n */\n\n/**\n * @ignore\n * @param {MapiClient} client\n * @param {Object} options\n * @param {string} options.method\n * @param {string} options.path\n * @param {Object} [options.query={}]\n * @param {Object} [options.params={}]\n * @param {string} [options.origin]\n * @param {Object} [options.headers]\n * @param {Object} [options.body=null]\n * @param {Blob|ArrayBuffer|string|ReadStream} [options.file=null]\n */\nfunction MapiRequest(client, options) {\n  if (!client) {\n    throw new Error('MapiRequest requires a client');\n  }\n  if (!options || !options.path || !options.method) {\n    throw new Error(\n      'MapiRequest requires an options object with path and method properties'\n    );\n  }\n\n  var defaultHeaders = {};\n  if (options.body) {\n    defaultHeaders['content-type'] = 'application/json';\n  }\n\n  var headersWithDefaults = xtend(defaultHeaders, options.headers);\n\n  // Disallows duplicate header names of mixed case,\n  // e.g. Content-Type and content-type.\n  var headers = Object.keys(headersWithDefaults).reduce(function(memo, name) {\n    memo[name.toLowerCase()] = headersWithDefaults[name];\n    return memo;\n  }, {});\n\n  this.id = requestId++;\n  this._options = options;\n\n  this.emitter = new EventEmitter();\n  this.client = client;\n  this.response = null;\n  this.error = null;\n  this.sent = false;\n  this.aborted = false;\n  this.path = options.path;\n  this.method = options.method;\n  this.origin = options.origin || client.origin;\n  this.query = options.query || {};\n  this.params = options.params || {};\n  this.body = options.body || null;\n  this.file = options.file || null;\n  this.headers = headers;\n}\n\n/**\n * Get the URL of the request.\n *\n * @param {string} [accessToken] - By default, the access token of the request's\n *   client is used.\n * @return {string}\n */\nMapiRequest.prototype.url = function url(accessToken) {\n  var url = urlUtils.prependOrigin(this.path, this.origin);\n  url = urlUtils.appendQueryObject(url, this.query);\n  var routeParams = this.params;\n  if (accessToken) {\n    url = urlUtils.appendQueryParam(url, 'access_token', accessToken);\n    var accessTokenOwnerId = parseToken(accessToken).user;\n    routeParams = xtend({ ownerId: accessTokenOwnerId }, routeParams);\n  }\n  url = urlUtils.interpolateRouteParams(url, routeParams);\n  return url;\n};\n\n/**\n * Send the request. Returns a Promise that resolves with a `MapiResponse`.\n * You probably want to use `response.body`.\n *\n * `send` only retrieves the first page of paginated results. You can get\n * the next page by using the `MapiResponse`'s [`nextPage`](#nextpage)\n * function, or iterate through all pages using [`eachPage`](#eachpage)\n * instead of `send`.\n *\n * @returns {Promise<MapiResponse>}\n */\nMapiRequest.prototype.send = function send() {\n  var self = this;\n\n  if (self.sent) {\n    throw new Error(\n      'This request has already been sent. Check the response and error properties. Create a new request with clone().'\n    );\n  }\n  self.sent = true;\n\n  return self.client.sendRequest(self).then(\n    function(response) {\n      self.response = response;\n      self.emitter.emit(constants.EVENT_RESPONSE, response);\n      return response;\n    },\n    function(error) {\n      self.error = error;\n      self.emitter.emit(constants.EVENT_ERROR, error);\n      throw error;\n    }\n  );\n};\n\n/**\n * Abort the request.\n *\n * Any pending `Promise` returned by [`send`](#send) will be rejected with\n * an error with `type: 'RequestAbortedError'`. If you've created a request\n * that might be aborted, you need to catch and handle such errors.\n *\n * This method will also abort any requests created while fetching subsequent\n * pages via [`eachPage`](#eachpage).\n *\n * If the request has not been sent or has already been aborted, nothing\n * will happen.\n */\nMapiRequest.prototype.abort = function abort() {\n  if (this._nextPageRequest) {\n    this._nextPageRequest.abort();\n    delete this._nextPageRequest;\n  }\n\n  if (this.response || this.error || this.aborted) return;\n\n  this.aborted = true;\n  this.client.abortRequest(this);\n};\n\n/**\n * Invoke a callback for each page of a paginated API response.\n *\n * The callback should have the following signature:\n *\n * ```js\n * (\n *   error: MapiError,\n *   response: MapiResponse,\n *   next: () => void\n * ) => void\n * ```\n *\n * **The next page will not be fetched until you've invoked the\n * `next` callback**, indicating that you're ready for it.\n *\n * @param {Function} callback\n */\nMapiRequest.prototype.eachPage = function eachPage(callback) {\n  var self = this;\n\n  function handleResponse(response) {\n    function getNextPage() {\n      delete self._nextPageRequest;\n      var nextPageRequest = response.nextPage();\n      if (nextPageRequest) {\n        self._nextPageRequest = nextPageRequest;\n        getPage(nextPageRequest);\n      }\n    }\n    callback(null, response, getNextPage);\n  }\n\n  function handleError(error) {\n    callback(error, null, function() {});\n  }\n\n  function getPage(request) {\n    request.send().then(handleResponse, handleError);\n  }\n  getPage(this);\n};\n\n/**\n * Clone this request.\n *\n * Each request can only be sent *once*. So if you'd like to send the\n * same request again, clone it and send away.\n *\n * @returns {MapiRequest} - A new `MapiRequest` configured just like this one.\n */\nMapiRequest.prototype.clone = function clone() {\n  return this._extend();\n};\n\n/**\n * @ignore\n */\nMapiRequest.prototype._extend = function _extend(options) {\n  var extendedOptions = xtend(this._options, options);\n  return new MapiRequest(this.client, extendedOptions);\n};\n\nmodule.exports = MapiRequest;\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","'use strict';\n\n// Encode each item of an array individually. The comma\n// delimiters should not themselves be encoded.\nfunction encodeArray(arrayValue) {\n  return arrayValue.map(encodeURIComponent).join(',');\n}\n\nfunction encodeValue(value) {\n  if (Array.isArray(value)) {\n    return encodeArray(value);\n  }\n  return encodeURIComponent(String(value));\n}\n\n/**\n * Append a query parameter to a URL.\n *\n * @param {string} url\n * @param {string} key\n * @param {string|number|boolean|Array<*>>} [value] - Provide an array\n *   if the value is a list and commas between values need to be\n *   preserved, unencoded.\n * @returns {string} - Modified URL.\n */\nfunction appendQueryParam(url, key, value) {\n  if (value === false || value === null) {\n    return url;\n  }\n  var punctuation = /\\?/.test(url) ? '&' : '?';\n  var query = encodeURIComponent(key);\n  if (value !== undefined && value !== '' && value !== true) {\n    query += '=' + encodeValue(value);\n  }\n  return '' + url + punctuation + query;\n}\n\n/**\n * Derive a query string from an object and append it\n * to a URL.\n *\n * @param {string} url\n * @param {Object} [queryObject] - Values should be primitives.\n * @returns {string} - Modified URL.\n */\nfunction appendQueryObject(url, queryObject) {\n  if (!queryObject) {\n    return url;\n  }\n\n  var result = url;\n  Object.keys(queryObject).forEach(function(key) {\n    var value = queryObject[key];\n    if (value === undefined) {\n      return;\n    }\n    if (Array.isArray(value)) {\n      value = value\n        .filter(function(v) {\n          return !!v;\n        })\n        .join(',');\n    }\n    result = appendQueryParam(result, key, value);\n  });\n  return result;\n}\n\n/**\n * Prepend an origin to a URL. If the URL already has an\n * origin, do nothing.\n *\n * @param {string} url\n * @param {string} origin\n * @returns {string} - Modified URL.\n */\nfunction prependOrigin(url, origin) {\n  if (!origin) {\n    return url;\n  }\n\n  if (url.slice(0, 4) === 'http') {\n    return url;\n  }\n\n  var delimiter = url[0] === '/' ? '' : '/';\n  return '' + origin.replace(/\\/$/, '') + delimiter + url;\n}\n\n/**\n * Interpolate values into a route with express-style,\n * colon-prefixed route parameters.\n *\n * @param {string} route\n * @param {Object} [params] - Values should be primitives\n *   or arrays of primitives. Provide an array if the value\n *   is a list and commas between values need to be\n *   preserved, unencoded.\n * @returns {string} - Modified URL.\n */\nfunction interpolateRouteParams(route, params) {\n  if (!params) {\n    return route;\n  }\n  return route.replace(/\\/:([a-zA-Z0-9]+)/g, function(_, paramId) {\n    var value = params[paramId];\n    if (value === undefined) {\n      throw new Error('Unspecified route parameter ' + paramId);\n    }\n    var preppedValue = encodeValue(value);\n    return '/' + preppedValue;\n  });\n}\n\nmodule.exports = {\n  appendQueryObject: appendQueryObject,\n  appendQueryParam: appendQueryParam,\n  prependOrigin: prependOrigin,\n  interpolateRouteParams: interpolateRouteParams\n};\n","'use strict';\n\nvar xtend = require('xtend');\nvar v = require('./service-helpers/validator');\nvar pick = require('./service-helpers/pick');\nvar stringifyBooleans = require('./service-helpers/stringify-booleans');\nvar createServiceFactory = require('./service-helpers/create-service-factory');\n\n/**\n * Geocoding API service.\n *\n * Learn more about this service and its responses in\n * [the HTTP service documentation](https://www.mapbox.com/api-documentation/#geocoding).\n */\nvar Geocoding = {};\n\nvar featureTypes = [\n  'country',\n  'region',\n  'postcode',\n  'district',\n  'place',\n  'locality',\n  'neighborhood',\n  'address',\n  'poi',\n  'poi.landmark'\n];\n\n/**\n * Search for a place.\n *\n * See the [public documentation](https://www.mapbox.com/api-documentation/#search-for-places).\n *\n * @param {Object} config\n * @param {string} config.query - A place name.\n * @param {'mapbox.places'|'mapbox.places-permanent'} [config.mode=\"mapbox.places\"] - Either `mapbox.places` for ephemeral geocoding, or `mapbox.places-permanent` for storing results and batch geocoding.\n * @param {Array<string>} [config.countries] - Limits results to the specified countries.\n *   Each item in the array should be an [ISO 3166 alpha 2 country code](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2).\n * @param {Coordinates} [config.proximity] - Bias local results based on a provided location.\n * @param {Array<'country'|'region'|'postcode'|'district'|'place'|'locality'|'neighborhood'|'address'|'poi'|'poi.landmark'>} [config.types] - Filter results by feature types.\n * @param {boolean} [config.autocomplete=true] - Return autocomplete results or not.\n * @param {BoundingBox} [config.bbox] - Limit results to a bounding box.\n * @param {number} [config.limit=5] - Limit the number of results returned.\n * @param {Array<string>} [config.language] - Specify the language to use for response text and, for forward geocoding, query result weighting.\n *  Options are [IETF language tags](https://en.wikipedia.org/wiki/IETF_language_tag) comprised of a mandatory\n *  [ISO 639-1 language code](https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes) and optionally one or more IETF subtags for country or script.\n * @return {MapiRequest}\n */\nGeocoding.forwardGeocode = function(config) {\n  v.assertShape({\n    query: v.required(v.string),\n    mode: v.oneOf('mapbox.places', 'mapbox.places-permanent'),\n    countries: v.arrayOf(v.string),\n    proximity: v.coordinates,\n    types: v.arrayOf(v.oneOf(featureTypes)),\n    autocomplete: v.boolean,\n    bbox: v.arrayOf(v.number),\n    limit: v.number,\n    language: v.arrayOf(v.string)\n  })(config);\n\n  config.mode = config.mode || 'mapbox.places';\n\n  var query = stringifyBooleans(\n    xtend(\n      { country: config.countries },\n      pick(config, [\n        'proximity',\n        'types',\n        'autocomplete',\n        'bbox',\n        'limit',\n        'language'\n      ])\n    )\n  );\n\n  return this.client.createRequest({\n    method: 'GET',\n    path: '/geocoding/v5/:mode/:query.json',\n    params: pick(config, ['mode', 'query']),\n    query: query\n  });\n};\n\n/**\n * Search for places near coordinates.\n *\n * See the [public documentation](https://www.mapbox.com/api-documentation/#retrieve-places-near-a-location).\n *\n * @param {Object} config\n * @param {Coordinates} config.query - Coordinates at which features will be searched.\n * @param {'mapbox.places'|'mapbox.places-permanent'} [config.mode=\"mapbox.places\"] - Either `mapbox.places` for ephemeral geocoding, or `mapbox.places-permanent` for storing results and batch geocoding.\n * @param {Array<string>} [config.countries] - Limits results to the specified countries.\n *   Each item in the array should be an [ISO 3166 alpha 2 country code](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2).\n * @param {Array<'country'|'region'|'postcode'|'district'|'place'|'locality'|'neighborhood'|'address'|'poi'|'poi.landmark'>} [config.types] - Filter results by feature types.\n * @param {BoundingBox} [config.bbox] - Limit results to a bounding box.\n * @param {number} [config.limit=1] - Limit the number of results returned. If using this option, you must provide a single item for `types`.\n * @param {Array<string>} [config.language] - Specify the language to use for response text and, for forward geocoding, query result weighting.\n *  Options are [IETF language tags](https://en.wikipedia.org/wiki/IETF_language_tag) comprised of a mandatory\n *  [ISO 639-1 language code](https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes) and optionally one or more IETF subtags for country or script.\n * @param {'distance'|'score'} [config.reverseMode='distance'] - Set the factors that are used to sort nearby results.\n * @return {MapiRequest}\n */\nGeocoding.reverseGeocode = function(config) {\n  v.assertShape({\n    query: v.required(v.coordinates),\n    mode: v.oneOf('mapbox.places', 'mapbox.places-permanent'),\n    countries: v.arrayOf(v.string),\n    types: v.arrayOf(v.oneOf(featureTypes)),\n    bbox: v.arrayOf(v.number),\n    limit: v.number,\n    language: v.arrayOf(v.string),\n    reverseMode: v.oneOf('distance', 'score')\n  })(config);\n\n  config.mode = config.mode || 'mapbox.places';\n\n  var query = stringifyBooleans(\n    xtend(\n      { country: config.countries },\n      pick(config, [\n        'country',\n        'types',\n        'bbox',\n        'limit',\n        'language',\n        'reverseMode'\n      ])\n    )\n  );\n\n  return this.client.createRequest({\n    method: 'GET',\n    path: '/geocoding/v5/:mode/:query.json',\n    params: pick(config, ['mode', 'query']),\n    query: query\n  });\n};\n\nmodule.exports = createServiceFactory(Geocoding);\n","'use strict';\n\nvar xtend = require('xtend');\nvar v = require('@mapbox/fusspot');\n\nfunction file(value) {\n  // If we're in a browser so Blob is available, the file must be that.\n  // In Node, however, it could be a filepath or a pipeable (Readable) stream.\n  if (typeof window !== 'undefined') {\n    if (value instanceof global.Blob || value instanceof global.ArrayBuffer) {\n      return;\n    }\n    return 'Blob or ArrayBuffer';\n  }\n  if (typeof value === 'string' || value.pipe !== undefined) {\n    return;\n  }\n  return 'Filename or Readable stream';\n}\n\nfunction assertShape(validatorObj, apiName) {\n  return v.assert(v.strictShape(validatorObj), apiName);\n}\n\nfunction date(value) {\n  var msg = 'date';\n  if (typeof value === 'boolean') {\n    return msg;\n  }\n  try {\n    var date = new Date(value);\n    if (date.getTime && isNaN(date.getTime())) {\n      return msg;\n    }\n  } catch (e) {\n    return msg;\n  }\n}\n\nfunction coordinates(value) {\n  return v.tuple(v.number, v.number)(value);\n}\n\nmodule.exports = xtend(v, {\n  file: file,\n  date: date,\n  coordinates: coordinates,\n  assertShape: assertShape\n});\n","'use strict';\n/**\n * Validators are functions which assert certain type.\n * They can return a string which can then be used\n * to display a helpful error message.\n * They can also return a function for a custom error message.\n */\nvar isPlainObject = require('is-plain-obj');\nvar xtend = require('xtend');\n\nvar DEFAULT_ERROR_PATH = 'value';\nvar NEWLINE_INDENT = '\\n  ';\n\nvar v = {};\n\n/**\n * Runners\n *\n * Take root validators and run assertion\n */\nv.assert = function(rootValidator, options) {\n  options = options || {};\n  return function(value) {\n    var message = validate(rootValidator, value);\n    // all good\n    if (!message) {\n      return;\n    }\n\n    var errorMessage = processMessage(message, options);\n\n    if (options.apiName) {\n      errorMessage = options.apiName + ': ' + errorMessage;\n    }\n\n    throw new Error(errorMessage);\n  };\n};\n\n/**\n * Higher Order Validators\n *\n * validators which take other validators as input\n * and output a new validator\n */\nv.shape = function shape(validatorObj) {\n  var validators = objectEntries(validatorObj);\n  return function shapeValidator(value) {\n    var validationResult = validate(v.plainObject, value);\n\n    if (validationResult) {\n      return validationResult;\n    }\n\n    var key, validator;\n    var errorMessages = [];\n\n    for (var i = 0; i < validators.length; i++) {\n      key = validators[i].key;\n      validator = validators[i].value;\n      validationResult = validate(validator, value[key]);\n\n      if (validationResult) {\n        // return [key].concat(validationResult);\n        errorMessages.push([key].concat(validationResult));\n      }\n    }\n\n    if (errorMessages.length < 2) {\n      return errorMessages[0];\n    }\n\n    // enumerate all the error messages\n    return function(options) {\n      errorMessages = errorMessages.map(function(message) {\n        var key = message[0];\n        var renderedMessage = processMessage(message, options)\n          .split('\\n')\n          .join(NEWLINE_INDENT); // indents any inner nesting\n        return '- ' + key + ': ' + renderedMessage;\n      });\n\n      var objectId = options.path.join('.');\n      var ofPhrase = objectId === DEFAULT_ERROR_PATH ? '' : ' of ' + objectId;\n\n      return (\n        'The following properties' +\n        ofPhrase +\n        ' have invalid values:' +\n        NEWLINE_INDENT +\n        errorMessages.join(NEWLINE_INDENT)\n      );\n    };\n  };\n};\n\nv.strictShape = function strictShape(validatorObj) {\n  var shapeValidator = v.shape(validatorObj);\n  return function strictShapeValidator(value) {\n    var shapeResult = shapeValidator(value);\n    if (shapeResult) {\n      return shapeResult;\n    }\n\n    var invalidKeys = Object.keys(value).reduce(function(memo, valueKey) {\n      if (validatorObj[valueKey] === undefined) {\n        memo.push(valueKey);\n      }\n      return memo;\n    }, []);\n\n    if (invalidKeys.length !== 0) {\n      return function() {\n        return 'The following keys are invalid: ' + invalidKeys.join(', ');\n      };\n    }\n  };\n};\n\nv.arrayOf = function arrayOf(validator) {\n  return createArrayValidator(validator);\n};\n\nv.tuple = function tuple() {\n  var validators = Array.isArray(arguments[0])\n    ? arguments[0]\n    : Array.prototype.slice.call(arguments);\n  return createArrayValidator(validators);\n};\n\n// Currently array validation fails when the first invalid item is found.\nfunction createArrayValidator(validators) {\n  var validatingTuple = Array.isArray(validators);\n  var getValidator = function(index) {\n    if (validatingTuple) {\n      return validators[index];\n    }\n    return validators;\n  };\n\n  return function arrayValidator(value) {\n    var validationResult = validate(v.plainArray, value);\n    if (validationResult) {\n      return validationResult;\n    }\n\n    if (validatingTuple && value.length !== validators.length) {\n      return 'an array with ' + validators.length + ' items';\n    }\n\n    for (var i = 0; i < value.length; i++) {\n      validationResult = validate(getValidator(i), value[i]);\n      if (validationResult) {\n        return [i].concat(validationResult);\n      }\n    }\n  };\n}\n\nv.required = function required(validator) {\n  function requiredValidator(value) {\n    if (value == null) {\n      return function(options) {\n        return formatErrorMessage(\n          options,\n          isArrayCulprit(options.path)\n            ? 'cannot be undefined/null.'\n            : 'is required.'\n        );\n      };\n    }\n    return validator.apply(this, arguments);\n  }\n  requiredValidator.__required = true;\n\n  return requiredValidator;\n};\n\nv.oneOfType = function oneOfType() {\n  var validators = Array.isArray(arguments[0])\n    ? arguments[0]\n    : Array.prototype.slice.call(arguments);\n  return function oneOfTypeValidator(value) {\n    var messages = validators\n      .map(function(validator) {\n        return validate(validator, value);\n      })\n      .filter(Boolean);\n\n    // If we don't have as many messages as no. of validators,\n    // then at least one validator was ok with the value.\n    if (messages.length !== validators.length) {\n      return;\n    }\n\n    // check primitive type\n    if (\n      messages.every(function(message) {\n        return message.length === 1 && typeof message[0] === 'string';\n      })\n    ) {\n      return orList(\n        messages.map(function(m) {\n          return m[0];\n        })\n      );\n    }\n\n    // Complex oneOfTypes like\n    // `v.oneOftypes(v.shape({name: v.string})`, `v.shape({name: v.number}))`\n    // are complex \\_()_/. For the current scope only returning the longest message.\n    return messages.reduce(function(max, arr) {\n      return arr.length > max.length ? arr : max;\n    });\n  };\n};\n\n/**\n * Meta Validators\n * which take options as argument (not validators)\n * and return a new primitive validator\n */\nv.equal = function equal(compareWith) {\n  return function equalValidator(value) {\n    if (value !== compareWith) {\n      return JSON.stringify(compareWith);\n    }\n  };\n};\n\nv.oneOf = function oneOf() {\n  var options = Array.isArray(arguments[0])\n    ? arguments[0]\n    : Array.prototype.slice.call(arguments);\n  var validators = options.map(function(value) {\n    return v.equal(value);\n  });\n\n  return v.oneOfType.apply(this, validators);\n};\n\nv.range = function range(compareWith) {\n  var min = compareWith[0];\n  var max = compareWith[1];\n  return function rangeValidator(value) {\n    var validationResult = validate(v.number, value);\n\n    if (validationResult || value < min || value > max) {\n      return 'number between ' + min + ' & ' + max + ' (inclusive)';\n    }\n  };\n};\n\n/**\n * Primitive validators\n *\n * simple validators which return a string or undefined\n */\nv.any = function any() {\n  return;\n};\n\nv.boolean = function boolean(value) {\n  if (typeof value !== 'boolean') {\n    return 'boolean';\n  }\n};\n\nv.number = function number(value) {\n  if (typeof value !== 'number') {\n    return 'number';\n  }\n};\n\nv.plainArray = function plainArray(value) {\n  if (!Array.isArray(value)) {\n    return 'array';\n  }\n};\n\nv.plainObject = function plainObject(value) {\n  if (!isPlainObject(value)) {\n    return 'object';\n  }\n};\n\nv.string = function string(value) {\n  if (typeof value !== 'string') {\n    return 'string';\n  }\n};\n\nv.func = function func(value) {\n  if (typeof value !== 'function') {\n    return 'function';\n  }\n};\n\nfunction validate(validator, value) {\n  // assertions are optional by default unless wrapped in v.require\n  if (value == null && !validator.hasOwnProperty('__required')) {\n    return;\n  }\n\n  var result = validator(value);\n\n  if (result) {\n    return Array.isArray(result) ? result : [result];\n  }\n}\n\nfunction processMessage(message, options) {\n  // message array follows the convention\n  // [...path, result]\n  // path is an array of object keys / array indices\n  // result is output of the validator\n  var len = message.length;\n\n  var result = message[len - 1];\n  var path = message.slice(0, len - 1);\n\n  if (path.length === 0) {\n    path = [DEFAULT_ERROR_PATH];\n  }\n  options = xtend(options, { path: path });\n\n  return typeof result === 'function'\n    ? result(options) // allows customization of result\n    : formatErrorMessage(options, prettifyResult(result));\n}\n\nfunction orList(list) {\n  if (list.length < 2) {\n    return list[0];\n  }\n  if (list.length === 2) {\n    return list.join(' or ');\n  }\n  return list.slice(0, -1).join(', ') + ', or ' + list.slice(-1);\n}\n\nfunction prettifyResult(result) {\n  return 'must be ' + addArticle(result) + '.';\n}\n\nfunction addArticle(nounPhrase) {\n  if (/^an? /.test(nounPhrase)) {\n    return nounPhrase;\n  }\n  if (/^[aeiou]/i.test(nounPhrase)) {\n    return 'an ' + nounPhrase;\n  }\n  if (/^[a-z]/i.test(nounPhrase)) {\n    return 'a ' + nounPhrase;\n  }\n  return nounPhrase;\n}\n\nfunction formatErrorMessage(options, prettyResult) {\n  var arrayCulprit = isArrayCulprit(options.path);\n  var output = options.path.join('.') + ' ' + prettyResult;\n  var prepend = arrayCulprit ? 'Item at position ' : '';\n\n  return prepend + output;\n}\n\nfunction isArrayCulprit(path) {\n  return typeof path[path.length - 1] == 'number' || typeof path[0] == 'number';\n}\n\nfunction objectEntries(obj) {\n  return Object.keys(obj || {}).map(function(key) {\n    return { key: key, value: obj[key] };\n  });\n}\n\nv.validate = validate;\nv.processMessage = processMessage;\n\nmodule.exports = v;\n","'use strict';\nvar toString = Object.prototype.toString;\n\nmodule.exports = function (x) {\n\tvar prototype;\n\treturn toString.call(x) === '[object Object]' && (prototype = Object.getPrototypeOf(x), prototype === null || prototype === Object.getPrototypeOf({}));\n};\n","'use strict';\n\n/**\n * Create a new object by picking properties off an existing object.\n * The second param can be overloaded as a callback for\n * more fine grained picking of properties.\n * @param {Object} source\n * @param {Array<string>|function(string, Object):boolean} keys\n * @returns {Object}\n */\nfunction pick(source, keys) {\n  var filter = function(key, val) {\n    return keys.indexOf(key) !== -1 && val !== undefined;\n  };\n\n  if (typeof keys === 'function') {\n    filter = keys;\n  }\n\n  return Object.keys(source)\n    .filter(function(key) {\n      return filter(key, source[key]);\n    })\n    .reduce(function(result, key) {\n      result[key] = source[key];\n      return result;\n    }, {});\n}\n\nmodule.exports = pick;\n","'use strict';\n\nvar objectMap = require('./object-map');\n\n/**\n * Stringify all the boolean values in an object, so true becomes \"true\".\n *\n * @param {Object} obj\n * @returns {Object}\n */\nfunction stringifyBoolean(obj) {\n  return objectMap(obj, function(_, value) {\n    return typeof value === 'boolean' ? JSON.stringify(value) : value;\n  });\n}\n\nmodule.exports = stringifyBoolean;\n","'use strict';\n\nfunction objectMap(obj, cb) {\n  return Object.keys(obj).reduce(function(result, key) {\n    result[key] = cb(key, obj[key]);\n    return result;\n  }, {});\n}\n\nmodule.exports = objectMap;\n","'use strict';\n\nvar MapiClient = require('../../lib/classes/mapi-client');\n// This will create the environment-appropriate client.\nvar createClient = require('../../lib/client');\n\nfunction createServiceFactory(ServicePrototype) {\n  return function(clientOrConfig) {\n    var client;\n    if (MapiClient.prototype.isPrototypeOf(clientOrConfig)) {\n      client = clientOrConfig;\n    } else {\n      client = createClient(clientOrConfig);\n    }\n    var service = Object.create(ServicePrototype);\n    service.client = client;\n    return service;\n  };\n}\n\nmodule.exports = createServiceFactory;\n","'use strict';\nvar nanoid = require('nanoid')\n\n/**\n * Construct a new mapbox event client to send interaction events to the mapbox event service\n * @param {Object} options options with which to create the service\n * @param {String} options.accessToken the mapbox access token to make requests\n * @param {Number} [options.flushInterval=1000] the number of ms after which to flush the event queue\n * @param {Number} [options.maxQueueSize=100] the number of events to queue before flushing\n * @private\n */\nfunction MapboxEventManager(options) {\n  this.origin = options.origin || 'https://api.mapbox.com';\n  this.endpoint = 'events/v2';\n  this.access_token = options.accessToken;\n  this.version = '0.2.0'\n  this.sessionID = this.generateSessionID();\n  this.userAgent = this.getUserAgent();\n\n  this.options = options;\n  this.send = this.send.bind(this);\n\n\n  // parse global options to be sent with each request\n  this.countries = (options.countries) ? options.countries.split(\",\") : null;\n  this.types = (options.types) ? options.types.split(\",\") : null;\n  this.bbox = (options.bbox) ? options.bbox : null;\n  this.language = (options.language) ? options.language.split(\",\") : null;\n  this.limit = (options.limit) ? +options.limit : null;\n  this.locale = navigator.language || null;\n  this.enableEventLogging = this.shouldEnableLogging(options);\n  this.eventQueue = new Array();\n  this.flushInterval = options.flushInterval || 1000;\n  this.maxQueueSize = options.maxQueueSize || 100;\n  this.timer = (this.flushInterval) ? setTimeout(this.flush.bind(this), this.flushInterval) : null;\n  // keep some state to deduplicate requests if necessary\n  this.lastSentInput = \"\";\n  this.lastSentIndex = 0;\n}\n\nMapboxEventManager.prototype = {\n  /**\n     * Send a search.select event to the mapbox events service\n     * This event marks the array index of the item selected by the user out of the array of possible options\n     * @private\n     * @param {Object} selected the geojson feature selected by the user\n     * @param {Object} geocoder a mapbox-gl-geocoder instance\n     * @returns {Promise}\n     */\n  select: function(selected, geocoder){\n    var resultIndex = this.getSelectedIndex(selected, geocoder);\n    var payload = this.getEventPayload('search.select', geocoder);\n    payload.resultIndex = resultIndex;\n    payload.resultPlaceName  = selected.place_name;\n    payload.resultId = selected.id;\n    if ((resultIndex === this.lastSentIndex && payload.queryString === this.lastSentInput) || resultIndex == -1) {\n      // don't log duplicate events if the user re-selected the same feature on the same search\n      return;\n    }\n    this.lastSentIndex = resultIndex;\n    this.lastSentInput = payload.queryString;\n    if (!payload.queryString) return; // will be rejected\n    return this.push(payload)\n  },\n\n  /**\n     * Send a search-start event to the mapbox events service\n     * This turnstile event marks when a user starts a new search\n     * @private\n     * @param {Object} geocoder a mapbox-gl-geocoder instance\n     * @returns {Promise}\n     */\n  start: function(geocoder){\n    var payload = this.getEventPayload('search.start', geocoder);\n    if (!payload.queryString) return; // will be rejected\n    return this.push(payload);\n  },\n\n  /**\n   * Send a search-keyevent event to the mapbox events service\n   * This event records each keypress in sequence\n   * @private\n   * @param {Object} keyEvent the keydown event to log\n   * @param {Obeject} geocoder a mapbox-gl-geocoder instance\n   * \n   */\n  keyevent: function(keyEvent, geocoder){\n\n    //pass invalid event\n    if (!keyEvent.key) return;\n    // don't send events for keys that don't change the input\n    // TAB, ESC, LEFT, RIGHT, ENTER, UP, DOWN\n    if (keyEvent.metaKey || [9, 27, 37, 39, 13, 38, 40].indexOf(keyEvent.keyCode) !== -1) return;\n    var payload = this.getEventPayload('search.keystroke', geocoder);\n    payload.lastAction = keyEvent.key;\n    if (!payload.queryString) return; // will be rejected\n    return this.push(payload);\n  },\n\n  /**\n   * Send an event to the events service\n   *\n   * The event is skipped if the instance is not enabled to send logging events\n   *\n   * @private\n   * @param {Object} payload the http POST body of the event\n   * @param {Function} [callback] a callback function to invoke when the send has completed\n   * @returns {Promise}\n   */\n  send: function (payload, callback) {\n    if (!this.enableEventLogging) {\n      if (callback) return callback();\n      return;\n    }\n    var options = this.getRequestOptions(payload);\n    this.request(options, function(err){\n      if (err) return this.handleError(err, callback);\n      if (callback) {\n        return callback();\n      }\n    }.bind(this))\n  },\n  /**\n   * Get http request options\n   * @private\n   * @param {*} payload\n   */\n  getRequestOptions: function(payload){\n    if (!Array.isArray(payload)) payload = [payload];\n    var options = {\n      // events must be sent with POST\n      method: \"POST\",\n      host: this.origin,\n      path: this.endpoint +  \"?access_token=\" + this.access_token,\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body:JSON.stringify(payload) //events are arrays\n    }\n    return options\n  },\n\n  /**\n   * Get the event payload to send to the events service\n   * Most payload properties are shared across all events\n   * @private\n   * @param {String} event the name of the event to send to the events service. Valid options are 'search.start', 'search.select', 'search.feedback'.\n   * @param {Object} geocoder a mapbox-gl-geocoder instance\n   * @returns {Object} an event payload\n   */\n  getEventPayload: function (event, geocoder) {\n    var proximity;\n    if (!geocoder.options.proximity) proximity = null;\n    else proximity = [geocoder.options.proximity.longitude, geocoder.options.proximity.latitude];\n\n    var zoom = (geocoder._map) ? geocoder._map.getZoom() : undefined;\n    var payload = {\n      event: event,\n      created: +new Date(),\n      sessionIdentifier: this.sessionID,\n      country: this.countries,\n      userAgent: this.userAgent,\n      language: this.language,\n      bbox: this.bbox,\n      types: this.types,\n      endpoint: 'mapbox.places',\n      // fuzzyMatch: search.fuzzy, //todo  --> add to plugin\n      proximity: proximity,\n      limit: geocoder.options.limit,\n      // routing: search.routing, //todo --> add to plugin\n      mapZoom: zoom,\n      keyboardLocale: this.locale\n    }\n\n    // get the text in the search bar\n    if (event === \"search.select\"){\n      payload.queryString = geocoder.inputString;\n    }else if (event != \"search.select\" && geocoder._inputEl){\n      payload.queryString = geocoder._inputEl.value;\n    }else{\n      payload.queryString = geocoder.inputString;\n    }\n    return payload;\n  },\n\n  /**\n   * Wraps the request function for easier testing\n   * Make an http request and invoke a callback\n   * @private\n   * @param {Object} opts options describing the http request to be made\n   * @param {Function} callback the callback to invoke when the http request is completed\n   */\n  request: function (opts, callback) {\n    var xhttp = new XMLHttpRequest();\n    xhttp.onreadystatechange = function() {\n      if (this.readyState == 4 ) {\n        if (this.status == 204){\n          //success\n          return callback(null);\n        }else {\n          return callback(this.statusText);\n        }\n      }\n    };\n\n    xhttp.open(opts.method, opts.host + '/' + opts.path, true);\n    for (var header in opts.headers){\n      var headerValue = opts.headers[header];\n      xhttp.setRequestHeader(header, headerValue)\n    }\n    xhttp.send(opts.body);\n  },\n\n  /**\n   * Handle an error that occurred while making a request\n   * @param {Object} err an error instance to log\n   * @private\n   */\n  handleError: function (err, callback) {\n    if (callback) return callback(err);\n  },\n\n  /**\n   * Generate a session ID to be returned with all of the searches made by this geocoder instance\n   * ID is random and cannot be tracked across sessions\n   * @private\n   */\n  generateSessionID: function () {\n    return nanoid();\n  },\n\n  /**\n   * Get a user agent string to send with the request to the events service\n   * @private\n   */\n  getUserAgent: function () {\n    return 'mapbox-gl-geocoder.' + this.version + \".\" + navigator.userAgent;\n  },\n\n  /**\n     * Get the 0-based numeric index of the item that the user selected out of the list of options\n     * @private\n     * @param {Object} selected the geojson feature selected by the user\n     * @param {Object} geocoder a Mapbox-GL-Geocoder instance\n     * @returns {Number} the index of the selected result\n     */\n  getSelectedIndex: function(selected, geocoder){\n    if (!geocoder._typeahead) return;\n    var results = geocoder._typeahead.data;\n    var selectedID = selected.id;\n    var resultIDs = results.map(function (feature) {\n      return feature.id;\n    });\n    var selectedIdx = resultIDs.indexOf(selectedID);\n    return selectedIdx;\n  },\n\n  /**\n     * Check whether events should be logged\n     * Clients using a localGeocoder or an origin other than mapbox should not have events logged\n     * @private\n     */\n  shouldEnableLogging: function(options){\n    if (options.enableEventLogging === false) return false;\n    if (options.origin && options.origin.indexOf('api.mapbox.com') == -1) return false;\n    // hard to make sense of events when a local instance is suplementing results from origin\n    if (options.localGeocoder) return false;\n    // hard to make sense of events when a custom filter is in use\n    if (options.filter) return false;\n    return true;\n  },\n\n  /**\n   * Flush out the event queue by sending events to the events service\n   * @private\n   */\n  flush: function(){\n    if (this.eventQueue.length > 0){\n      this.send(this.eventQueue);\n      this.eventQueue = new Array();\n    }\n    // //reset the timer\n    if (this.timer)  clearTimeout(this.timer);\n    if (this.flushInterval) this.timer = setTimeout(this.flush.bind(this), this.flushInterval)\n  },\n\n  /**\n   * Push event into the pending queue\n   * @param {Object} evt the event to send to the events service\n   * @param {Boolean} forceFlush indicates that the event queue should be flushed after adding this event regardless of size of the queue\n   * @private\n   */\n  push: function(evt, forceFlush){\n    this.eventQueue.push(evt);\n    if (this.eventQueue.length >= this.maxQueueSize || forceFlush){\n      this.flush();\n    }\n  },\n\n  /**\n   * Flush any remaining events from the queue before it is removed\n   * @private\n   */\n  remove: function(){\n    this.flush();\n  }\n}\n\n\n\nmodule.exports = MapboxEventManager;\n","// This file replaces `index.js` in bundlers like webpack or Rollup,\n// according to `browser` config in `package.json`.\n\nif (process.env.NODE_ENV !== 'production') {\n  // All bundlers will remove this block in production bundle\n  if (typeof navigator !== 'undefined' && navigator.product === 'ReactNative') {\n    throw new Error(\n      'React Native does not have a built-in secure random generator. ' +\n      'If you dont need unpredictable IDs, you can use `nanoid/non-secure`. ' +\n      'For secure ID install `expo-random` locally and use `nanoid/async`.'\n    )\n  }\n  if (typeof self === 'undefined' || (!self.crypto && !self.msCrypto)) {\n    throw new Error(\n      'Your browser does not have secure random generator. ' +\n      'If you dont need unpredictable IDs, you can use nanoid/non-secure.'\n    )\n  }\n}\n\nvar crypto = self.crypto || self.msCrypto\n\n// This alphabet uses a-z A-Z 0-9 _- symbols.\n// Despite the fact the source code is quite long, its entropy\n// is low and there are lots of duplicates - just what compressors\n// like GZIP and Brotli likes the best.\nvar i\nvar url = '_-' + String.fromCharCode(\n  // ASCII codes for 0...9\n  i = 48, i += 1, i += 1, i += 1, i += 1, i += 1, i += 1, i += 1,\n  i += 1, i += 1,\n\n  // ASCII codes for A...Z\n  i += 8, i += 1, i += 1, i += 1, i += 1, i += 1, i += 1, i += 1,\n  i += 1, i += 1, i += 1, i += 1, i += 1, i += 1, i += 1, i += 1,\n  i += 1, i += 1, i += 1, i += 1, i += 1, i += 1, i += 1, i += 1,\n  i += 1, i += 1,\n\n  // ASCII codes for a...z\n  i += 7, i += 1, i += 1, i += 1, i += 1, i += 1, i += 1, i += 1,\n  i += 1, i += 1, i += 1, i += 1, i += 1, i += 1, i += 1, i += 1,\n  i += 1, i += 1, i += 1, i += 1, i += 1, i += 1, i += 1, i += 1,\n  i += 1, i += 1\n)\n\nmodule.exports = function (size) {\n  size = size || 21\n  var id = ''\n  var bytes = crypto.getRandomValues(new Uint8Array(size))\n  // Compact alternative for `for (var i = 0; i < size; i++)`\n  while (size--) {\n    // We cant use bytes bigger than the alphabet. 63 is 00111111 bitmask.\n    // This mask reduces random byte 0-255 to 0-63 values.\n    // There is no need in `|| ''` and `* 1.6` hacks in here,\n    // because bitmask trim bytes exact to alphabet size.\n    id += url[bytes[size] & 63]\n  }\n  return id\n}\n","'use strict';\n\n/**\n * Localized values for the placeholder string\n * \n * @private\n */\nvar placeholder = {\n  // list drawn from https://docs.mapbox.com/api/search/#language-coverage\n  'de': 'Suche', // german\n  'it': 'Ricerca', //italian\n  'en': 'Search', // english\n  'nl': 'Zoeken', //dutch\n  'fr': 'Chercher',  //french\n  'ca': 'Cerca', //catalan\n  'he': '', //hebrew\n  'ja': '',  //japanese\n  'lv': 'Meklt', //latvian\n  'pt': 'Procurar', //portuguese \n  'sr': '', //serbian\n  'zh': '', //chinese-simplified\n  'cs': 'Vyhledvn', //czech\n  'hu': 'Keress', //hungarian\n  'ka': '', // georgian\n  'nb': 'Ske', //norwegian\n  'sk': 'Vyhadvanie', //slovak\n  'th': '', //thai\n  'fi': 'Hae',//finnish\n  'is': 'Leita',//icelandic\n  'ko': '',//korean\n  'pl':  'Szukaj', //polish\n  'sl': 'Iskanje', //slovenian\n  'fa': '' //persian(aka farsi)\n}\n\nmodule.exports = {placeholder: placeholder};\n","!function(root, name, make) {\r\n  if (typeof module != 'undefined' && module.exports) module.exports = make()\r\n  else root[name] = make()\r\n}(this, 'subtag', function() {\r\n\r\n  var empty = ''\r\n  var pattern = /^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/\r\n\r\n  function match(tag) {\r\n    return tag.match(pattern) || []\r\n  }\r\n\r\n  function split(tag) {\r\n    return match(tag).filter(function(v, i) { return v && i })\r\n  }\r\n\r\n  function api(tag) {\r\n    tag = match(tag)\r\n    return {\r\n      language: tag[1] || empty,\r\n      extlang: tag[2] || empty,\r\n      script: tag[3] || empty,\r\n      region: tag[4] || empty\r\n    }\r\n  }\r\n\r\n  function expose(target, key, value) {\r\n    Object.defineProperty(target, key, {\r\n      value: value,\r\n      enumerable: true\r\n    })\r\n  }\r\n\r\n  function part(position, pattern, type) {\r\n    function method(tag) {\r\n      return match(tag)[position] || empty\r\n    }\r\n    expose(method, 'pattern', pattern)\r\n    expose(api, type, method)\r\n  }\r\n\r\n  part(1, /^[a-zA-Z]{2,3}$/, 'language')\r\n  part(2, /^[a-zA-Z]{3}$/, 'extlang')\r\n  part(3, /^[a-zA-Z]{4}$/, 'script')\r\n  part(4, /^[a-zA-Z]{2}$|^[0-9]{3}$/, 'region')\r\n\r\n  expose(api, 'split', split)\r\n\r\n  return api\r\n});\r\n"],"sourceRoot":""}